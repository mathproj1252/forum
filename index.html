<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.8">
    <title>Сайт-форум MathProj</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            CommonHTML: { linebreaks: { automatic: true } },
    "HTML-CSS": { linebreaks: { automatic: true } },
    SVG: { linebreaks: { automatic: true } },
    showProcessingMessages: false,
            messageStyle: 'none'
        });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    // Инициализация Supabase - ЗАМЕНИТЕ НА ВАШИ РЕАЛЬНЫЕ ДАННЫЕ
    const supabaseUrl = 'https://icinmrmefhqavemeeexz.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImljaW5tcm1lZmhxYXZlbWVlZXh6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAyNTM1MTEsImV4cCI6MjA3NTgyOTUxMX0.Boza1RmPpeKEiDBLj48Wh5aEzSCikwSSbITOgDc78mU';
    const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

    // Класс для работы с Supabase
    class SupabaseDatabase {
        constructor() {
            this.client = supabaseClient;
        }

        async init() {
            return Promise.resolve();
        }

        // Пользователи
        async addUser(userData) {
            const { data, error } = await this.client
                .from('users')
                .insert([userData])
                .select()
                .single();
            
            if (error) throw error;
            return data;
        }

        async getUser(userId) {
            const { data, error } = await this.client
                .from('users')
                .select('*')
                .eq('id', userId)
                .single();
            
            if (error) return null;
            return data;
        }

        async getUserByEmail(email) {
            const { data, error } = await this.client
                .from('users')
                .select('*')
                .eq('email', email)
                .single();
            
            if (error) return null;
            return data;
        }

        async getAllUsers() {
            const { data, error } = await this.client
                .from('users')
                .select('*');
            
            if (error) return [];
            return data;
        }

        async updateUser(userId, userData) {
            const { data, error } = await this.client
                .from('users')
                .update(userData)
                .eq('id', userId)
                .select()
                .single();
            
            if (error) throw error;
            return data;
        }

        async deleteUser(userId) {
            const { error } = await this.client
                .from('users')
                .delete()
                .eq('id', userId);
            
            if (error) throw error;
        }

        // Задачи
        async addProblem(problemData) {
            const { data, error } = await this.client
                .from('problems')
                .insert([problemData])
                .select()
                .single();
            
            if (error) throw error;
            return data;
        }

async getProblem(problemId) {
    const { data, error } = await this.client
        .from('problems')
        .select(`
            *,
            solutions (*),
            comments (*)
        `)
        .eq('id', problemId)
        .single();
    
    if (error) {
        console.error('Ошибка при получении задачи:', error);
        return null;
    }
    
    // Добавляем совместимость со старым кодом
    if (data) {
        data.authorId = data.author_id;
        data.bestSolutionId = data.best_solution_id;
        if (!data.solutions) data.solutions = [];
        if (!data.comments) data.comments = [];
        if (!data.likes) data.likes = [];
        if (!data.dislikes) data.dislikes = [];
        if (!data.favorites) data.favorites = [];
        if (!data.images) data.images = [];
        // Добавляем вычисляемое поле date
        data.date = data.created_at ? new Date(data.created_at).toLocaleDateString('ru-RU') : 'Неизвестно';
    }
    
    return data;
}

async getAllProblems() {
    const { data, error } = await this.client
        .from('problems')
        .select('*')
        .order('created_at', { ascending: false });
    
    if (error) {
        console.error('Ошибка при получении задач:', error);
        return [];
    }
    
    // Добавляем совместимость
    data.forEach(problem => {
        problem.authorId = problem.author_id;
        problem.bestSolutionId = problem.best_solution_id;
        if (!problem.solutions) problem.solutions = [];
        if (!problem.comments) problem.comments = [];
        if (!problem.likes) problem.likes = [];
        if (!problem.dislikes) problem.dislikes = [];
        if (!problem.favorites) problem.favorites = [];
        if (!problem.images) problem.images = [];
        // Добавляем вычисляемое поле date
        problem.date = problem.created_at ? new Date(problem.created_at).toLocaleDateString('ru-RU') : 'Неизвестно';
    });
    
    return data;
}

        async updateProblem(problemId, problemData) {
    // Преобразуем названия полей для соответствия БД
    const dbProblemData = { ...problemData };
    
    // Если есть поля с camelCase, преобразуем их в snake_case
    if (dbProblemData.bestSolutionId !== undefined) {
        dbProblemData.best_solution_id = dbProblemData.bestSolutionId;
        delete dbProblemData.bestSolutionId;
    }
    
    if (dbProblemData.authorId !== undefined) {
        dbProblemData.author_id = dbProblemData.authorId;
        delete dbProblemData.authorId;
    }
    
    const { data, error } = await this.client
        .from('problems')
        .update(dbProblemData)
        .eq('id', problemId)
        .select()
        .single();
    
    if (error) {
        console.error('Ошибка при обновлении задачи:', error);
        throw error;
    }
    
    // Возвращаем с совместимыми полями
    if (data) {
        data.authorId = data.author_id;
        data.bestSolutionId = data.best_solution_id;
        if (!data.solutions) data.solutions = [];
        if (!data.comments) data.comments = [];
    }
    
    return data;
}

        async deleteProblem(problemId) {
            // Сначала удаляем связанные решения и комментарии
            await this.client.from('solutions').delete().eq('problem_id', problemId);
            await this.client.from('comments').delete().eq('problem_id', problemId);
            
            // Затем удаляем задачу
            const { error } = await this.client
                .from('problems')
                .delete()
                .eq('id', problemId);
            
            if (error) throw error;
        }

        // Решения
        async addSolution(solutionData) {
            const { data, error } = await this.client
                .from('solutions')
                .insert([solutionData])
                .select()
                .single();
            
            if (error) throw error;
            return data;
        }

        async getSolution(solutionId) {
            const { data, error } = await this.client
                .from('solutions')
                .select('*')
                .eq('id', solutionId)
                .single();
            
            if (error) return null;
            return data;
        }

        async updateSolution(solutionId, solutionData) {
            const { data, error } = await this.client
                .from('solutions')
                .update(solutionData)
                .eq('id', solutionId)
                .select()
                .single();
            
            if (error) throw error;
            return data;
        }

        async deleteSolution(solutionId) {
            const { error } = await this.client
                .from('solutions')
                .delete()
                .eq('id', solutionId);
            
            if (error) throw error;
        }

        // Комментарии
        async addComment(commentData) {
            const { data, error } = await this.client
                .from('comments')
                .insert([commentData])
                .select()
                .single();
            
            if (error) throw error;
            return data;
        }

        async getComment(commentId) {
            const { data, error } = await this.client
                .from('comments')
                .select('*')
                .eq('id', commentId)
                .single();
            
            if (error) return null;
            return data;
        }

        async updateComment(commentId, commentData) {
            const { data, error } = await this.client
                .from('comments')
                .update(commentData)
                .eq('id', commentId)
                .select()
                .single();
            
            if (error) throw error;
            return data;
        }

        async deleteComment(commentId) {
            const { error } = await this.client
                .from('comments')
                .delete()
                .eq('id', commentId);
            
            if (error) throw error;
        }

        // Поиск
        async searchProblems(searchTerm) {
            const { data, error } = await this.client
                .from('problems')
                .select('*')
                .or(`title.ilike.%${searchTerm}%,content.ilike.%${searchTerm}%,author.ilike.%${searchTerm}%`)
                .order('created_at', { ascending: false });
            
            if (error) return [];
            return data;
        }
    }

    // Глобальные переменные
    const forumDB = new SupabaseDatabase();
    let currentProblemId = null;
    let problems = [];
    let currentUser = null;
    let users = [];
    let currentSort = 'date';
    let currentPage = 1;
    const problemsPerPage = 10;
    let totalPages = 1;
    let currentProblems = [];
    let searchResults = [];
    let isSearchActive = false;

    // Константы для ограничений
    const MAX_IMAGE_SIZE = 2 * 1024 * 1024;
    const MAX_IMAGE_DIMENSION = 2000;
    const MAX_IMAGES_PER_ITEM = 1;

    // Флаг для отслеживания инициализации
    let isInitialized = false;

    // Функция загрузки задач (с пагинацией)
function loadProblems(problemsArray = problems) {
    const problemsList = document.getElementById('problems-list');
    problemsList.innerHTML = '<h2 class="section-title"><i class="fas fa-tasks"></i>Задачи</h2>';
    
    if (isSearchActive && searchResults.length > 0) {
        currentProblems = searchResults;
    } else {
        currentProblems = problemsArray;
        isSearchActive = false;
    }
    
    calculateTotalPages(currentProblems);
    
    if (currentProblems.length === 0) {
        problemsList.innerHTML += `
            <div class="empty-state">
                <i class="fas fa-clipboard-list"></i>
                <h3>Пока нет добавленных задач</h3>
                <p>Будьте первым, кто добавит задачу!</p>
            </div>
        `;
        
        document.getElementById('pagination-container').style.display = 'none';
        document.getElementById('pagination-top-container').style.display = 'none';
        return;
    }
    
    const sortedProblems = sortProblems([...currentProblems]);
    const startIndex = (currentPage - 1) * problemsPerPage;
    const endIndex = startIndex + problemsPerPage;
    const problemsToShow = sortedProblems.slice(startIndex, endIndex);
    
    problemsToShow.forEach(problem => {
        const problemEl = document.createElement('div');
        problemEl.className = 'problem';
        
        let difficultyClass = '';
        if (problem.difficulty === 'легкая') difficultyClass = 'difficulty-easy';
        if (problem.difficulty === 'средняя') difficultyClass = 'difficulty-medium';
        if (problem.difficulty === 'сложная') difficultyClass = 'difficulty-hard';
        
        const userLiked = currentUser && problem.likes && problem.likes.includes(currentUser.id);
        const userDisliked = currentUser && problem.dislikes && problem.dislikes.includes(currentUser.id);
        const isFavorited = currentUser && problem.favorites && problem.favorites.includes(currentUser.id);
        
        let imagePreview = '';
        if (problem.images && problem.images.length > 0) {
            const imageContainer = document.createElement('div');
            imageContainer.className = 'attached-images';
            
            const img = document.createElement('img');
            img.src = problem.images[0].data;
            img.className = 'attached-image';
            img.onclick = function() {
                openImageModal(problem.images[0].data);
            };
            imageContainer.appendChild(img);
            
            if (problem.images.length > 1) {
                const span = document.createElement('span');
                span.textContent = `+${problem.images.length - 1} изображений`;
                imageContainer.appendChild(span);
            }
            
            imagePreview = imageContainer.outerHTML;
        }
        
        const canDelete = currentUser && (problem.author_id === currentUser.id || isAdmin(currentUser));
    
        problemEl.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                <h3>${escapeHtml(problem.title)}</h3>
                <button class="favorite-btn ${isFavorited ? 'favorited' : ''}" data-id="${problem.id}" title="${isFavorited ? 'Удалить из избранного' : 'Добавить в избранное'}">
                    <i class="${isFavorited ? 'fas' : 'far'} fa-star"></i>
                </button>
            </div>
            <p>${escapeHtml(problem.content.substring(0, 150))}${problem.content.length > 150 ? '...' : ''}</p>
            ${imagePreview}
            <div class="problem-meta">
                <span>ID: ${problem.id}</span>
                <span>Автор: ${escapeHtml(problem.author)}</span>
                <span>Дата: ${problem.date || 'Неизвестно'}</span>
                <span class="${difficultyClass}">Сложность: ${problem.difficulty}</span>
            </div>
            <div>
                ${problem.tags ? problem.tags.map(tag => `<span class="tag">${escapeHtml(tag)}</span>`).join('') : ''}
            </div>
            <div class="reactions">
                <button class="reaction-btn ${userLiked ? 'liked' : ''}" data-type="like" data-id="${problem.id}">
                    <i class="fas fa-thumbs-up"></i>
                    <span class="reaction-count">${problem.likes ? problem.likes.length : 0}</span>
                </button>
                <button class="reaction-btn ${userDisliked ? 'disliked' : ''}" data-type="dislike" data-id="${problem.id}">
                    <i class="fas fa-thumbs-down"></i>
                    <span class="reaction-count">${problem.dislikes ? problem.dislikes.length : 0}</span>
                </button>
            </div>
            <div class="problem-actions">
                <button class="btn view-problem" data-id="${problem.id}">
                    <i class="fas fa-eye"></i> Посмотреть задачу
                </button>
                ${canDelete ? 
                    `<button class="btn btn-secondary btn-sm delete-problem-list" data-id="${problem.id}">
                        <i class="fas fa-trash"></i> Удалить
                    </button>` : ''}
            </div>
        `;
        
        problemsList.appendChild(problemEl);
    });
    
    updatePagination();
}

    // Инициализация при загрузке страницы
    document.addEventListener('DOMContentLoaded', async function() {
        if (isInitialized) return;
        isInitialized = true;
        
        console.log('Инициализация приложения...');
        
        await initializeData();
        loadProblems();
        updateCounters();
        setupEventListeners();
        setupSearchHandlers();
        showProblemsList();
        checkAuthState();
        setupImageUploadHandlers();
        setupCharacterCounters();
        
        // Обработка MathJax
        MathJax.Hub.Queue(function() {
            MathJax.Hub.Register.MessageHook("Math Processing Error", function(message) {
                console.log("MathJax error: ", message);
            });
            
            function updateMathJax() {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            }

            const observer = new MutationObserver(function(mutations) {
                let shouldUpdate = false;
                
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'characterData' || mutation.addedNodes.length > 0) {
                        shouldUpdate = true;
                    }
                });

                if (shouldUpdate) {
                    setTimeout(updateMathJax, 1);
                }
            });

            observer.observe(document.body, {
                childList: true,
                subtree: true,
                characterData: true
            });

            updateMathJax();
        });
    });

    // Инициализация данных
    async function initializeData() {
    showLoading();
    try {
        await forumDB.init();
        
        // Загружаем пользователей
        users = await forumDB.getAllUsers();
        console.log('Пользователи загружены:', users.length);
        
        // Загружаем задачи
        problems = await forumDB.getAllProblems();
        console.log('Задачи загружены:', problems.length);
        
        // Инициализируем недостающие поля для совместимости
        problems.forEach(problem => {
            if (!problem.likes) problem.likes = [];
            if (!problem.dislikes) problem.dislikes = [];
            if (!problem.images) problem.images = [];
            if (!problem.favorites) problem.favorites = [];
            if (!problem.bestSolutionId) problem.bestSolutionId = null;
            if (!problem.solutions) problem.solutions = [];
            if (!problem.comments) problem.comments = [];
            
            // Для совместимости со старым кодом
            problem.authorId = problem.author_id;
            problem.date = problem.created_at ? new Date(problem.created_at).toLocaleDateString('ru-RU') : problem.date;
        });
        
        const savedUser = localStorage.getItem('current_user');
        if (savedUser) {
            currentUser = JSON.parse(savedUser);
            console.log('Текущий пользователь:', currentUser);
            
            // Обновляем данные пользователя из базы
            const freshUser = await forumDB.getUser(currentUser.id);
            if (freshUser) {
                currentUser = { ...currentUser, ...freshUser };
                localStorage.setItem('current_user', JSON.stringify(currentUser));
            }
        }
        
        hideLoading();
        
    } catch (error) {
        console.error('Error initializing data:', error);
        hideLoading();
        users = [];
        problems = [];
        showErrorMessage('Ошибка при загрузке данных. Пожалуйста, обновите страницу.');
    }
}

    // Функции для работы с задачами
async function addProblem() {
    if (!currentUser) {
        showAuthModal();
        return;
    }
    
    const title = document.getElementById('problem-title').value.trim();
    const content = document.getElementById('problem-content').value.trim();
    const tags = document.getElementById('problem-tags').value;
    const difficulty = document.getElementById('problem-difficulty').value;
    const imageFiles = document.getElementById('problem-images').files;
    
    // Валидация длины названия
    if (title.length < 5 || title.length > 200) {
        showErrorMessage('Название задачи должно содержать от 5 до 200 символов');
        return;
    }
    
    // Валидация длины условия
    if (content.length < 10 || content.length > 2000) {
        showErrorMessage('Условие задачи должно содержать от 10 до 2000 символов');
        return;
    }
    
    // Валидация тегов
    const tagArray = tags.split(',').map(tag => tag.trim()).filter(tag => tag !== '');
    if (tagArray.length > 10) {
        showErrorMessage('Можно указать не более 10 тегов');
        return;
    }
    
    for (const tag of tagArray) {
        if (tag.length > 30) {
            showErrorMessage('Каждый тег должен быть не длиннее 30 символов');
            return;
        }
    }
    
    if (title && content) {
        showLoading();
        try {
            const images = await readImageFiles(imageFiles);
            
            // ИСПРАВЛЕННЫЙ ОБЪЕКТ - БЕЗ ПОЛЯ date
            const newProblem = {
                title: title,
                content: content,
                author: currentUser.name,
                author_id: currentUser.id,
                tags: tagArray,
                difficulty: difficulty,
                images: images,
                likes: [],
                dislikes: [],
                favorites: [],
                best_solution_id: null,
                created_at: new Date().toISOString()
            };
            
            console.log('Добавляем задачу:', newProblem);
            
            const addedProblem = await forumDB.addProblem(newProblem);
            console.log('Задача добавлена:', addedProblem);
            
            // Добавляем локальные поля для совместимости
            addedProblem.solutions = addedProblem.solutions || [];
            addedProblem.comments = addedProblem.comments || [];
            addedProblem.authorId = addedProblem.author_id;
            addedProblem.bestSolutionId = addedProblem.best_solution_id;
            // Добавляем поле date для отображения (вычисляемое поле)
            addedProblem.date = new Date(addedProblem.created_at).toLocaleDateString('ru-RU');
            
            problems.push(addedProblem);
            
            // Очистка формы
            document.getElementById('problem-title').value = '';
            document.getElementById('problem-content').value = '';
            document.getElementById('problem-tags').value = '';
            document.getElementById('problem-difficulty').value = 'легкая';
            document.getElementById('problem-images').value = '';
            document.getElementById('problem-file-names').textContent = '';
            document.getElementById('problem-image-previews').innerHTML = '';
            
            showSuccessMessage('Ваша задача успешно добавлена!');
            currentPage = 1;
            loadProblems();
            updateCounters();
            showProblemsList();
            setActiveNav(document.getElementById('nav-problems'));
            
        } catch (error) {
            console.error('Ошибка при добавлении задачи:', error);
            showErrorMessage('Произошла ошибка при добавлении задачи: ' + error.message);
        }
        hideLoading();
    } else {
        showErrorMessage('Пожалуйста, заполните все обязательные поля');
    }
}

    async function addSolution() {
        if (!currentUser) {
            showAuthModal();
            return;
        }
        
        if (!currentProblemId) return;
        
        const content = document.getElementById('solution-content').value;
        const imageFiles = document.getElementById('solution-images').files;
        
        // Валидация длины решения
        if (content.length < 10 || content.length > 3000) {
            showSuccessMessage('Решение должно содержать от 10 до 3000 символов');
            return;
        }
    
        if (content) {
            showLoading();
            try {
                const images = await readImageFiles(imageFiles);
                
                const newSolution = {
                    id: Date.now(),
                    problem_id: currentProblemId,
                    author: currentUser.name,
                    author_id: currentUser.id,
                    content: content,
                    images: images,
                    date: new Date().toLocaleDateString('ru-RU'),
                    likes: [],
                    dislikes: [],
                    created_at: new Date().toISOString()
                };
                
                const addedSolution = await forumDB.addSolution(newSolution);
                
                // Обновляем локальный список проблем
                const problem = problems.find(p => p.id === currentProblemId);
                if (problem) {
                    if (!problem.solutions) problem.solutions = [];
                    problem.solutions.push(addedSolution);
                }
                
                document.getElementById('solution-content').value = '';
                document.getElementById('solution-images').value = '';
                document.getElementById('solution-file-names').textContent = '';
                document.getElementById('solution-image-previews').innerHTML = '';
                
                showProblemDetail(currentProblemId);
                updateCounters();
                showSuccessMessage('Решение успешно добавлено!');
                
            } catch (error) {
                console.error('Ошибка при добавлении решения:', error);
                alert('Произошла ошибка при добавлении решения. Пожалуйста, попробуйте еще раз.');
            }
            hideLoading();
        } else {
            alert('Пожалуйста, заполните поле с решением');
        }
    }

    async function addComment() {
        if (!currentUser) {
            showAuthModal();
            return;
        }
        
        if (!currentProblemId) return;
        
        const content = document.getElementById('comment-content').value;
        const imageFiles = document.getElementById('comment-images').files;
        
        // Валидация длины комментария
        if (content.length < 10 || content.length > 3000) {
            showSuccessMessage('Комментарий должен содержать от 10 до 3000 символов');
            return;
        }
    
        if (content) {
            showLoading();
            try {
                const images = await readImageFiles(imageFiles);
            
                const newComment = {
                    id: Date.now(),
                    problem_id: currentProblemId,
                    author: currentUser.name,
                    author_id: currentUser.id,
                    content: content,
                    images: images,
                    date: new Date().toLocaleDateString('ru-RU'),
                    likes: [],
                    dislikes: [],
                    created_at: new Date().toISOString()
                };
                
                const addedComment = await forumDB.addComment(newComment);
                
                // Обновляем локальный список проблем
                const problem = problems.find(p => p.id === currentProblemId);
                if (problem) {
                    if (!problem.comments) problem.comments = [];
                    problem.comments.push(addedComment);
                }
                
                document.getElementById('comment-content').value = '';
                document.getElementById('comment-images').value = '';
                document.getElementById('comment-file-names').textContent = '';
                document.getElementById('comment-image-previews').innerHTML = '';
                
                showProblemDetail(currentProblemId);
                updateCounters();
                showSuccessMessage('Комментарий успешно добавлен!');
            } catch (error) {
                console.error('Ошибка при добавлении комментария:', error);
                alert('Произошла ошибка при добавлении комментария. Пожалуйста, попробуйте еще раз.');
            }
            hideLoading();
        } else {
            alert('Пожалуйста, заполните поле с комментарием');
        }
    }

    async function deleteProblem(problemId) {
        if (!confirm('Вы уверены, что хотите удалить задачу?')) return;
        
        showLoading();
        
        try {
            await forumDB.deleteProblem(problemId);
            
            // Обновляем локальный список
            const problemIndex = problems.findIndex(p => p.id === problemId);
            if (problemIndex !== -1) {
                problems.splice(problemIndex, 1);
            }
            
            if (currentProblemId === problemId) {
                showProblemsList();
            } else {
                calculateTotalPages();
                if (currentPage > totalPages && totalPages > 0) {
                    currentPage = totalPages;
                }
                loadProblems();
            }
            
            updateCounters();
            showSuccessMessage('Задача удалена!');
        } catch (error) {
            console.error('Ошибка при удалении задачи:', error);
            alert('Ошибка при удалении задачи.');
        } finally {
            hideLoading();
        }
    }

    async function deleteSolution(problemId, solutionIndex) {
        if (!confirm('Вы уверены, что хотите удалить решение?')) return;
        
        const problem = problems.find(p => p.id === problemId);
        
        if (problem && problem.solutions && solutionIndex < problem.solutions.length) {
            const solution = problem.solutions[solutionIndex];
            
            try {
                await forumDB.deleteSolution(solution.id);
                
                if (problem.best_solution_id === solution.id) {
                    problem.best_solution_id = null;
                    await forumDB.updateProblem(problemId, { best_solution_id: null });
                }
                
                problem.solutions.splice(solutionIndex, 1);
                
                showProblemDetail(problemId);
                updateCounters();
                showSuccessMessage('Решение удалено!');
            } catch (error) {
                console.error('Ошибка при удалении решения:', error);
                alert('Ошибка при удалении решения.');
            }
        }
    }

    async function deleteComment(problemId, commentIndex) {
        if (!confirm('Вы уверены, что хотите удалить комментарий?')) return;
        
        const problem = problems.find(p => p.id === problemId);
        
        if (problem && problem.comments && commentIndex < problem.comments.length) {
            const comment = problem.comments[commentIndex];
            
            try {
                await forumDB.deleteComment(comment.id);
                problem.comments.splice(commentIndex, 1);
                
                showProblemDetail(problemId);
                updateCounters();
                showSuccessMessage('Комментарий удален!');
            } catch (error) {
                console.error('Ошибка при удалении комментария:', error);
                alert('Ошибка при удалении комментария.');
            }
        }
    }

    async function handleReaction(itemType, problemId, solutionIndex, commentIndex, reactionType) {
        if (!currentUser) {
            showAuthModal();
            return;
        }
        
        let item;
        let problem = problems.find(p => p.id === problemId);
        
        if (!problem) return;
        
        if (itemType === 'problem') {
            item = problem;
        } else if (itemType === 'solution') {
            if (problem.solutions && solutionIndex !== null) {
                item = problem.solutions[solutionIndex];
            }
        } else if (itemType === 'comment') {
            if (problem.comments && commentIndex !== null) {
                item = problem.comments[commentIndex];
            }
        }
        
        if (!item) return;
        
        const userId = currentUser.id;
        const liked = item.likes && item.likes.includes(userId);
        const disliked = item.dislikes && item.dislikes.includes(userId);
        
        if (!item.likes) item.likes = [];
        if (!item.dislikes) item.dislikes = [];
        
        if (reactionType === 'like') {
            if (liked) {
                item.likes = item.likes.filter(id => id !== userId);
            } else {
                item.likes.push(userId);
                if (disliked) {
                    item.dislikes = item.dislikes.filter(id => id !== userId);
                }
            }
        } else if (reactionType === 'dislike') {
            if (disliked) {
                item.dislikes = item.dislikes.filter(id => id !== userId);
            } else {
                item.dislikes.push(userId);
                if (liked) {
                    item.likes = item.likes.filter(id => id !== userId);
                }
            }
        }
        
        try {
            // Обновляем в базе данных
            if (itemType === 'problem') {
                await forumDB.updateProblem(problemId, {
                    likes: item.likes,
                    dislikes: item.dislikes
                });
            } else if (itemType === 'solution') {
                await forumDB.updateSolution(item.id, {
                    likes: item.likes,
                    dislikes: item.dislikes
                });
            } else if (itemType === 'comment') {
                await forumDB.updateComment(item.id, {
                    likes: item.likes,
                    dislikes: item.dislikes
                });
            }
            
            // Обновляем отображение
            if (itemType === 'problem') {
                if (document.getElementById('problem-detail').style.display !== 'none') {
                    showProblemDetail(problemId);
                } else {
                    loadProblems();
                }
            } else if (itemType === 'solution' || itemType === 'comment') {
                showProblemDetail(problemId);
            }
        } catch (error) {
            console.error('Ошибка при обновлении реакции:', error);
        }
    }

    async function toggleFavorite(problemId) {
        if (!currentUser) {
            showAuthModal();
            return;
        }
        
        const problem = problems.find(p => p.id === problemId);
        if (!problem) return;
        
        if (!problem.favorites) {
            problem.favorites = [];
        }
        
        const userId = currentUser.id;
        const isFavorited = problem.favorites.includes(userId);
        
        if (isFavorited) {
            problem.favorites = problem.favorites.filter(id => id !== userId);
        } else {
            const userFavoritesCount = problems.filter(p => 
                p.favorites && p.favorites.includes(userId)
            ).length;
            
            if (userFavoritesCount >= 50) {
                showSuccessMessage('Достигнут лимит избранных задач (максимум 50). Удалите некоторые задачи из избранного, чтобы добавить новые.');
                return;
            }
            
            problem.favorites.push(userId);
        }
        
        try {
            await forumDB.updateProblem(problemId, {
                favorites: problem.favorites
            });
            
            if (document.getElementById('problem-detail').style.display !== 'none') {
                showProblemDetail(problemId);
            } else {
                loadProblems();
            }
            
            if (document.getElementById('profile-section').style.display !== 'none') {
                loadProfileData();
            }
            
            const message = isFavorited ? 'Задача удалена из избранного' : 'Задача добавлена в избранное';
            showSuccessMessage(message);
        } catch (error) {
            console.error('Ошибка при обновлении избранного:', error);
        }
    }

    async function toggleBestSolution(problemId, solutionId) {
        if (!currentUser) {
            showAuthModal();
            return;
        }
        
        const problem = problems.find(p => p.id === problemId);
        if (!problem || problem.author_id !== currentUser.id) return;
        
        if (problem.best_solution_id === solutionId) {
            problem.best_solution_id = null;
        } else {
            problem.best_solution_id = solutionId;
        }
        
        try {
            await forumDB.updateProblem(problemId, {
                best_solution_id: problem.best_solution_id
            });
            
            showProblemDetail(problemId);
            
            if (document.getElementById('profile-section').style.display !== 'none') {
                loadProfileData();
            }
        } catch (error) {
            console.error('Ошибка при обновлении лучшего решения:', error);
        }
    }

    // Функции для работы с пользователями
    async function register() {
        const name = document.getElementById('register-name').value;
        const email = document.getElementById('register-email').value;
        const password = document.getElementById('register-password').value;
        const passwordConfirm = document.getElementById('register-password-confirm').value;
        const errorElement = document.getElementById('register-error');
        
        // Очищаем предыдущие ошибки
        document.getElementById('register-password-error').textContent = '';
        errorElement.textContent = '';
        
        if (!name || !email || !password || !passwordConfirm) {
            errorElement.textContent = 'Заполните все поля';
            return;
        }
        
        // Проверяем длину имени
        if (name.length > 40) {
            errorElement.textContent = 'Имя пользователя должно быть не длиннее 40 символов';
            return;
        }
        
        // Проверяем сложность пароля
        if (!validatePassword(password)) {
            document.getElementById('register-password-error').textContent = 
                'Пароль не соответствует требованиям';
            return;
        }
        
        if (password !== passwordConfirm) {
            errorElement.textContent = 'Пароли не совпадают';
            return;
        }
        
        // Проверяем существование пользователя
        const existingUser = await forumDB.getUserByEmail(email);
        if (existingUser) {
            errorElement.textContent = 'Пользователь с таким email уже существует';
            return;
        }
        
        // Проверяем существование имени
        const allUsers = await forumDB.getAllUsers();
        if (allUsers.some(u => u.name.toLowerCase() === name.toLowerCase())) {
            errorElement.textContent = 'Пользователь с таким именем уже существует';
            return;
        }
        
        showLoading();
        
        try {
            const newUser = {
                id: Date.now(),
                name: name,
                email: email,
                password: password,
                registration_date: new Date().toLocaleDateString('ru-RU'),
                description: ''
            };
            
            await forumDB.addUser(newUser);
            users.push(newUser);
            
            currentUser = {
                id: newUser.id,
                name: newUser.name,
                email: newUser.email,
                registrationDate: newUser.registration_date,
                description: newUser.description
            };
            
            localStorage.setItem('current_user', JSON.stringify(currentUser));
            
            checkAuthState();
            hideAuthModal();
            showProblemsList();
            showSuccessMessage(`Регистрация успешна! Добро пожаловать, ${name}!`);
            
        } catch (error) {
            console.error('Ошибка при регистрации:', error);
            errorElement.textContent = 'Ошибка при регистрации. Попробуйте еще раз.';
        } finally {
            hideLoading();
        }
    }

    async function login() {
        const email = document.getElementById('login-email').value;
        const password = document.getElementById('login-password').value;
        const errorElement = document.getElementById('login-error');
        
        if (!email || !password) {
            errorElement.textContent = 'Заполните все поля';
            return;
        }
        
        try {
            const user = await forumDB.getUserByEmail(email);
            
            if (user && user.password === password) {
                showLoading();
                currentUser = {
                    id: user.id,
                    name: user.name,
                    email: user.email,
                    registrationDate: user.registration_date,
                    description: user.description || ''
                };
                
                localStorage.setItem('current_user', JSON.stringify(currentUser));
                checkAuthState();
                hideAuthModal();
                showProblemsList();
                setActiveNav(document.getElementById('nav-problems'));
                showSuccessMessage(`Добро пожаловать, ${user.name}!`);
            } else {
                errorElement.textContent = 'Неверный email или пароль';
            }
            hideLoading();
        } catch (error) {
            console.error('Ошибка при входе:', error);
            errorElement.textContent = 'Ошибка при входе. Попробуйте еще раз.';
        }
    }

    function logout() {
        currentUser = null;
        localStorage.removeItem('current_user');
        checkAuthState();
        showSuccessMessage('Вы вышли из аккаунта');
        showProblemsList();
        location.reload();
    }

    async function deleteAccount() {
        if (!currentUser) return;
        
        if (!confirm('Вы уверены, что хотите удалить аккаунт? Это действие нельзя отменить.')) {
            return;
        }
        
        try {
            // Удаляем задачи пользователя
            const userProblems = problems.filter(problem => problem.author_id === currentUser.id);
            for (const problem of userProblems) {
                await forumDB.deleteProblem(problem.id);
            }
            
            // Удаляем решения и комментарии пользователя из других задач
            const otherProblems = problems.filter(problem => problem.author_id !== currentUser.id);
            for (const problem of otherProblems) {
                // Удаляем решения пользователя
                if (problem.solutions) {
                    const userSolutions = problem.solutions.filter(solution => solution.author_id === currentUser.id);
                    for (const solution of userSolutions) {
                        await forumDB.deleteSolution(solution.id);
                    }
                }
                
                // Удаляем комментарии пользователя
                if (problem.comments) {
                    const userComments = problem.comments.filter(comment => comment.author_id === currentUser.id);
                    for (const comment of userComments) {
                        await forumDB.deleteComment(comment.id);
                    }
                }
                
                // Убираем пользователя из избранного и реакций
                if (problem.favorites && problem.favorites.includes(currentUser.id)) {
                    problem.favorites = problem.favorites.filter(id => id !== currentUser.id);
                    await forumDB.updateProblem(problem.id, { favorites: problem.favorites });
                }
                
                if (problem.likes && problem.likes.includes(currentUser.id)) {
                    problem.likes = problem.likes.filter(id => id !== currentUser.id);
                    await forumDB.updateProblem(problem.id, { likes: problem.likes });
                }
                
                if (problem.dislikes && problem.dislikes.includes(currentUser.id)) {
                    problem.dislikes = problem.dislikes.filter(id => id !== currentUser.id);
                    await forumDB.updateProblem(problem.id, { dislikes: problem.dislikes });
                }
            }
            
            // Удаляем аккаунт пользователя
            await forumDB.deleteUser(currentUser.id);
            
            logout();
            location.reload();
                    
        } catch (error) {
            console.error('Ошибка при удалении аккаунта:', error);
            alert('Ошибка при удалении аккаунта.');
        }
    }

    async function saveDescription() {
        if (!currentUser) return;
        
        showLoading();
        
        const description = document.getElementById('account-description').value;
        
        if (description.length > 100) {
            showSuccessMessage('Описание не может превышать 100 символов');
            return;
        }
        
        currentUser.description = description;
        
        try {
            await forumDB.updateUser(currentUser.id, { description: description });
            
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].description = description;
            }
            
            localStorage.setItem('current_user', JSON.stringify(currentUser));
            loadProfileData();
            showSuccessMessage('Описание профиля сохранено!');
        } catch (error) {
            console.error('Ошибка при сохранении описания:', error);
            showSuccessMessage('Ошибка при сохранении описания.');
        }
    
        hideLoading();
    }

    async function changePassword() {
        if (!currentUser) return;
        
        const oldPassword = document.getElementById('old-password').value;
        const newPassword = document.getElementById('new-password').value;
        const confirmNewPassword = document.getElementById('confirm-new-password').value;
        
        // Очищаем предыдущие ошибки
        document.getElementById('new-password-error').textContent = '';
        document.getElementById('confirm-password-error').textContent = '';
        
        // Проверяем, что все поля заполнены
        if (!oldPassword || !newPassword || !confirmNewPassword) {
            showSuccessMessage('Заполните все поля для изменения пароля');
            return;
        }
        
        // Проверяем старый пароль
        const user = await forumDB.getUser(currentUser.id);
        if (!user || user.password !== oldPassword) {
            showSuccessMessage('Старый пароль указан неверно');
            return;
        }
        
        // Проверяем новый пароль
        if (!validatePassword(newPassword)) {
            document.getElementById('new-password-error').textContent = 
                'Пароль не соответствует требованиям';
            return;
        }
        
        // Проверяем подтверждение пароля
        if (newPassword !== confirmNewPassword) {
            document.getElementById('confirm-password-error').textContent = 
                'Пароли не совпадают';
            return;
        }
        
        showLoading();
        
        try {
            // Обновляем пароль
            await forumDB.updateUser(currentUser.id, { password: newPassword });
            
            // Очищаем поля
            document.getElementById('old-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-new-password').value = '';
            
            showSuccessMessage('Пароль успешно изменен!');
        } catch (error) {
            console.error('Ошибка при изменении пароля:', error);
            showSuccessMessage('Ошибка при изменении пароля. Попробуйте еще раз.');
        }
        
        hideLoading();
    }

    // Остальные функции остаются практически без изменений
    function calculateTotalPages() {
        totalPages = Math.ceil(currentProblems.length / problemsPerPage);
        return totalPages;
    }

    function setPage(page) {
        if (page < 1 || page > totalPages) return;
        
        currentPage = page;
        loadProblems();
        document.getElementById('problems-list').scrollIntoView({ behavior: 'smooth' });
    }

    function updatePagination() {
        const paginationContainer = document.getElementById('pagination-container');
        const paginationTopContainer = document.getElementById('pagination-top-container');
        
        renderPagination(paginationContainer);
        renderPagination(paginationTopContainer);
    }

    function renderPagination(container) {
        container.innerHTML = '';
        
        if (totalPages <= 1) {
            container.style.display = 'none';
            return;
        }
        
        container.style.display = 'block';
        
        const paginationEl = document.createElement('div');
        paginationEl.className = 'pagination';
        
        const pageInfo = document.createElement('div');
        pageInfo.className = 'page-info';
        const startProblem = (currentPage - 1) * problemsPerPage + 1;
        const endProblem = Math.min(currentPage * problemsPerPage, currentProblems.length);
        pageInfo.textContent = `Задачи ${startProblem}-${endProblem} из ${currentProblems.length}`;
        
        const prevButton = document.createElement('button');
        prevButton.className = 'pagination-btn';
        prevButton.innerHTML = '<i class="fas fa-chevron-left"></i>';
        prevButton.disabled = currentPage === 1;
        prevButton.addEventListener('click', function() {
            setPage(currentPage - 1);
        });
        
        const pageNumbers = document.createElement('div');
        pageNumbers.className = 'page-numbers';
        
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(totalPages, currentPage + 2);
        
        if (currentPage <= 3) {
            endPage = Math.min(5, totalPages);
        }
        if (currentPage >= totalPages - 2) {
            startPage = Math.max(1, totalPages - 4);
        }
        
        if (startPage > 1) {
            const firstPageButton = document.createElement('button');
            firstPageButton.className = 'pagination-btn';
            firstPageButton.textContent = '1';
            firstPageButton.addEventListener('click', function() {
                setPage(1);
            });
            pageNumbers.appendChild(firstPageButton);
            
            if (startPage > 2) {
                const ellipsis = document.createElement('span');
                ellipsis.className = 'pagination-ellipsis';
                ellipsis.textContent = '...';
                pageNumbers.appendChild(ellipsis);
            }
        }
        
        for (let i = startPage; i <= endPage; i++) {
            const pageButton = document.createElement('button');
            pageButton.className = `pagination-btn ${i === currentPage ? 'active' : ''}`;
            pageButton.textContent = i;
            pageButton.addEventListener('click', function() {
                setPage(i);
            });
            pageNumbers.appendChild(pageButton);
        }
        
        if (endPage < totalPages) {
            if (endPage < totalPages - 1) {
                const ellipsis = document.createElement('span');
                ellipsis.className = 'pagination-ellipsis';
                ellipsis.textContent = '...';
                pageNumbers.appendChild(ellipsis);
            }
            
            const lastPageButton = document.createElement('button');
            lastPageButton.className = 'pagination-btn';
            lastPageButton.textContent = totalPages;
            lastPageButton.addEventListener('click', function() {
                setPage(totalPages);
            });
            pageNumbers.appendChild(lastPageButton);
        }
        
        const nextButton = document.createElement('button');
        nextButton.className = 'pagination-btn';
        nextButton.innerHTML = '<i class="fas fa-chevron-right"></i>';
        nextButton.disabled = currentPage === totalPages;
        nextButton.addEventListener('click', function() {
            setPage(currentPage + 1);
        });
        
        paginationEl.appendChild(prevButton);
        paginationEl.appendChild(pageNumbers);
        paginationEl.appendChild(nextButton);
        
        container.appendChild(pageInfo);
        container.appendChild(paginationEl);
    }
    
    // Сортировка задач
    function sortProblems(problemsArray) {
        if (currentSort === 'date') {
            return problemsArray.sort((a, b) => {
                const dateA = a.created_at ? new Date(a.created_at) : new Date(a.id);
                const dateB = b.created_at ? new Date(b.created_at) : new Date(b.id);
                return dateB - dateA;
            });
        } else {
            return problemsArray.sort((a, b) => {
                const aLikes = a.likes ? a.likes.length : 0;
                const bLikes = b.likes ? b.likes.length : 0;
                return bLikes - aLikes;
            });
        }
    }
    
    // Функция обновления счетчиков
    function updateCounters() {
        document.getElementById('total-problems').textContent = problems.length;
        
        let solutionsCount = 0;
        let commentsCount = 0;
        
        problems.forEach(problem => {
            solutionsCount += problem.solutions ? problem.solutions.length : 0;
            commentsCount += problem.comments ? problem.comments.length : 0;
        });
        
        document.getElementById('total-solutions').textContent = solutionsCount;
        document.getElementById('total-comments').textContent = commentsCount;
    }

    // Настройка обработчиков событий
    let eventListenersSetup = false;

    function setupEventListeners() {
        if (eventListenersSetup) return;
        eventListenersSetup = true;
        
        console.log('Настройка обработчиков событий...');
        
        // Проверяем, что кнопка существует
    const submitProblemBtn = document.getElementById('submit-problem');
    if (submitProblemBtn) {
        submitProblemBtn.addEventListener('click', addProblem);
        console.log('Обработчик для добавления задачи установлен');
    } else {
        console.error('Кнопка submit-problem не найдена!');
    }
    
    // Навигация
        document.getElementById('nav-problems').addEventListener('click', function(e) {
            e.preventDefault();
            showProblemsList();
            setActiveNav(this);
        });
        
        document.getElementById('nav-add').addEventListener('click', function(e) {
            e.preventDefault();
            showAddProblemForm();
            setActiveNav(this);
        });
        
        document.getElementById('nav-about').addEventListener('click', function(e) {
            e.preventDefault();
            showFaqModal();
            setActiveNav(this);
        });
        
        // Добавление задачи
        document.getElementById('submit-problem').addEventListener('click', addProblem);
        
        // Кнопка "Назад к списку задач"
        document.getElementById('back-to-problems').addEventListener('click', showProblemsList);
        
        // Поиск
        document.getElementById('search-btn').addEventListener('click', searchProblems);
        document.getElementById('search-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchProblems();
            }
        });
        
        // Отправка решения и комментария
        document.getElementById('submit-solution').addEventListener('click', addSolution);
        document.getElementById('submit-comment').addEventListener('click', addComment);
        
        // Добавляем обработчик для кнопки изменения пароля
            document.getElementById('change-password-btn').addEventListener('click', changePassword);
            
        // Настраиваем счетчики символов
        setupCharacterCounters();
        
        // Система аккаунтов
        document.getElementById('login-btn').addEventListener('click', showAuthModal);
        document.getElementById('logout-btn').addEventListener('click', logout);
        
        // Модальное окно авторизации
        document.getElementById('auth-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideAuthModal();
            }
        });
        
        document.querySelectorAll('.auth-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                switchAuthTab(this.getAttribute('data-tab'));
            });
        });
        
        // Обработчики для кнопок LaTeX-панели
        document.querySelectorAll('.latex-btn').forEach(button => {
            button.addEventListener('click', function() {
                const textarea = document.getElementById('problem-content');
                const code = this.getAttribute('data-insert');
                insertAtCursor(textarea, code);
                updateLatexPreview();
                textarea.focus();
            });
        });
        
        // Обновление предпросмотра при изменении текста
        const problemContentTextarea = document.getElementById('problem-content');
        if (problemContentTextarea) {
            problemContentTextarea.addEventListener('input', updateLatexPreview);
        }
        
        document.getElementById('switch-to-register').addEventListener('click', function() {
            switchAuthTab('register');
        });
        
        document.getElementById('switch-to-login').addEventListener('click', function() {
            switchAuthTab('login');
        });
        
        document.getElementById('submit-login').addEventListener('click', login);
        document.getElementById('submit-register').addEventListener('click', register);
        
        // Кнопки для входа при необходимости
        document.getElementById('login-for-problem').addEventListener('click', showAuthModal);
        document.getElementById('login-for-solution').addEventListener('click', showAuthModal);
        document.getElementById('login-for-comment').addEventListener('click', showAuthModal);
        
        // Кнопка удаления задачи
        document.getElementById('delete-problem').addEventListener('click', deleteCurrentProblem);
        
        // Модальное окно для изображений
        document.getElementById('close-modal').addEventListener('click', function() {
            document.getElementById('image-modal').style.display = 'none';
        });
        
        document.getElementById('image-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                document.getElementById('image-modal').style.display = 'none';
            }
        });
        
        // Модальное окно FAQ - ИСПРАВЛЕННЫЙ КОД АККОРДЕОНА
        document.getElementById('close-faq').addEventListener('click', hideFaqModal);
        
        document.getElementById('faq-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideFaqModal();
            }
        });
        
        // ИСПРАВЛЕННЫЙ ОБРАБОТЧИК ДЛЯ АККОРДЕОНА FAQ
        document.getElementById('faq-modal').addEventListener('click', function(e) {
            const question = e.target.closest('.faq-question');
            if (question) {
                const answer = question.nextElementSibling;
                const icon = question.querySelector('i');
                
                // Закрываем все открытые ответы
                document.querySelectorAll('.faq-answer').forEach(ans => {
                    if (ans !== answer) {
                        ans.style.display = 'none';
                    }
                });
                
                // Обновляем все иконки
                document.querySelectorAll('.faq-question i').forEach(ic => {
                    if (ic !== icon) {
                        ic.classList.remove('fa-chevron-up');
                        ic.classList.add('fa-chevron-down');
                    }
                });
                
                // Переключаем текущий ответ
                if (answer.style.display === 'block') {
                    answer.style.display = 'none';
                    icon.classList.remove('fa-chevron-up');
                    icon.classList.add('fa-chevron-down');
                } else {
                    answer.style.display = 'block';
                    icon.classList.remove('fa-chevron-down');
                    icon.classList.add('fa-chevron-up');
                }
                
                e.stopPropagation();
            }
        });
        
        // Кнопки сортировки
        document.getElementById('sort-by-date').addEventListener('click', function() {
            setSortMethod('date');
        });
        
        document.getElementById('sort-by-popularity').addEventListener('click', function() {
            setSortMethod('popularity');
        });
        
        // Предпросмотр задачи
        document.getElementById('preview-problem').addEventListener('click', showProblemPreview);
        document.getElementById('close-preview').addEventListener('click', hideProblemPreview);
        document.getElementById('preview-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideProblemPreview();
            }
        });
        
        // Навигация профиля
        document.getElementById('nav-profile').addEventListener('click', function(e) {
            e.preventDefault();
            showProfile();
            setActiveNav(this);
        });
        
        document.getElementById('login-for-profile').addEventListener('click', showAuthModal);
        
        // Кнопка удаления аккаунта
        document.getElementById('delete-account-btn').addEventListener('click', deleteAccount);
        
        // Обработчики для редактирования описания профиля
        document.getElementById('account-description').addEventListener('input', updateCharacterCount);
        document.getElementById('save-description-btn').addEventListener('click', saveDescription);
        
        // ДЕЛЕГИРОВАНИЕ СОБЫТИЙ ДЛЯ ДИНАМИЧЕСКИ СОЗДАВАЕМЫХ ЭЛЕМЕНТОВ
        document.getElementById('problems-list').addEventListener('click', function(e) {
            // Просмотр задачи
            if (e.target.closest('.view-problem')) {
                const button = e.target.closest('.view-problem');
                const problemId = parseInt(button.getAttribute('data-id'));
                showProblemDetail(problemId);
            }
            
            // Удаление задачи из списка
            if (e.target.closest('.delete-problem-list')) {
                const button = e.target.closest('.delete-problem-list');
                const problemId = parseInt(button.getAttribute('data-id'));
                deleteProblem(problemId);
            }
            
            // Реакции в списке задач
            if (e.target.closest('.reaction-btn')) {
                if (!currentUser) {
                    showAuthModal();
                    return;
                }
                
                const button = e.target.closest('.reaction-btn');
                const problemId = parseInt(button.getAttribute('data-id'));
                const reactionType = button.getAttribute('data-type');
                handleReaction('problem', problemId, null, null, reactionType);
            }
            
            // Избранное в списке задач
            if (e.target.closest('.favorite-btn')) {
                if (!currentUser) {
                    showAuthModal();
                    return;
                }
                
                const button = e.target.closest('.favorite-btn');
                const problemId = parseInt(button.getAttribute('data-id'));
                toggleFavorite(problemId);
            }
        });
        
        // Для деталей задачи (решения и комментарии)
        document.getElementById('problem-detail').addEventListener('click', function(e) {
            // Реакции на решения
            if (e.target.closest('.solution .reaction-btn')) {
                if (!currentUser) {
                    showAuthModal();
                    return;
                }
                
                const button = e.target.closest('.reaction-btn');
                const problemId = parseInt(button.getAttribute('data-problem'));
                const solutionIndex = parseInt(button.getAttribute('data-index'));
                const reactionType = button.getAttribute('data-type');
                handleReaction('solution', problemId, solutionIndex, null, reactionType);
            }
            
            // Реакции на комментарии
            if (e.target.closest('.comment .reaction-btn')) {
                if (!currentUser) {
                    showAuthModal();
                    return;
                }
                
                const button = e.target.closest('.reaction-btn');
                const problemId = parseInt(button.getAttribute('data-problem'));
                const commentIndex = parseInt(button.getAttribute('data-index'));
                const reactionType = button.getAttribute('data-type');
                handleReaction('comment', problemId, null, commentIndex, reactionType);
            }
            
            // Удаление решений
            if (e.target.closest('.delete-solution')) {
                const button = e.target.closest('.delete-solution');
                const solutionIndex = parseInt(button.getAttribute('data-index'));
                deleteSolution(currentProblemId, solutionIndex);
            }
            
            // Удаление комментариев
            if (e.target.closest('.delete-comment')) {
                const button = e.target.closest('.delete-comment');
                const commentIndex = parseInt(button.getAttribute('data-index'));
                deleteComment(currentProblemId, commentIndex);
            }
            
            // Отметка как лучшего решения
            if (e.target.closest('.toggle-best-solution-btn')) {
                const button = e.target.closest('.toggle-best-solution-btn');
                const solutionId = parseInt(button.getAttribute('data-solution-id'));
                toggleBestSolution(currentProblemId, solutionId);
            }
        });

        // Обработчик для переключения темы
        const themeToggle = document.getElementById('theme-toggle');
        const savedTheme = localStorage.getItem('theme');
        
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-theme');
            themeToggle.checked = true;
        }
        
        themeToggle.addEventListener('change', function() {
            if (this.checked) {
                document.body.classList.add('dark-theme');
                localStorage.setItem('theme', 'dark');
            } else {
                document.body.classList.remove('dark-theme');
                localStorage.setItem('theme', 'light');
            }
            
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        });
    }

    // Функция показа списка задач
    function showProblemsList() {
        showLoading();
        document.getElementById('problems-list').style.display = 'block';
        document.getElementById('problem-detail').style.display = 'none';
        document.getElementById('pagination-container').style.display = 'block';
        document.getElementById('pagination-top-container').style.display = 'block';
        document.getElementById('add-problem-section').style.display = 'none';
        document.getElementById('profile-section').style.display = 'none';
        
        document.querySelector('.search-box').style.display = 'flex';
        document.querySelector('.sort-options').style.display = 'flex';
        
        const searchInput = document.getElementById('search-input');
        if (searchInput.value.trim() === '') {
            isSearchActive = false;
            searchResults = [];
        }
        
        loadProblems();
        hideLoading();
    }

    // Функция для безопасного вывода HTML
    function escapeHtml(unsafe) {
        if (!unsafe) return '';
        return unsafe
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;");
    }

    // Обработчик очистки поиска
    function setupSearchHandlers() {
        const searchInput = document.getElementById('search-input');
        
        searchInput.addEventListener('input', function() {
            if (this.value.trim() === '') {
                isSearchActive = false;
                searchResults = [];
                currentPage = 1;
                loadProblems();
            }
        });
    }

    // Функция поиска задач
    async function searchProblems() {
        showLoading();
        
        const searchTerm = document.getElementById('search-input').value.toLowerCase();
        
        currentPage = 1;
        
        if (searchTerm.trim() === '') {
            isSearchActive = false;
            searchResults = [];
            loadProblems();
            hideLoading();
            return;
        }
        
        try {
            searchResults = await forumDB.searchProblems(searchTerm);
            isSearchActive = true;
            loadProblems(searchResults);
        } catch (error) {
            console.error('Ошибка при поиске:', error);
            searchResults = [];
            loadProblems();
        }
        
        hideLoading();
    }

    // Функции для работы с системой аккаунтов (без изменений)
    function showAuthModal() {
        document.getElementById('auth-modal').style.display = 'flex';
        switchAuthTab('login');
    }

    function hideAuthModal() {
        document.getElementById('auth-modal').style.display = 'none';
        document.getElementById('login-email').value = '';
        document.getElementById('login-password').value = '';
        document.getElementById('login-error').textContent = '';
        
        document.getElementById('register-name').value = '';
        document.getElementById('register-email').value = '';
        document.getElementById('register-password').value = '';
        document.getElementById('register-password-confirm').value = '';
        document.getElementById('register-error').textContent = '';
    }

    function switchAuthTab(tab) {
        document.querySelectorAll('.auth-tab').forEach(t => {
            t.classList.remove('active');
        });
        
        document.querySelectorAll('.auth-form').forEach(form => {
            form.classList.remove('active');
        });
        
        document.querySelector(`.auth-tab[data-tab="${tab}"]`).classList.add('active');
        document.getElementById(`${tab}-form`).classList.add('active');
    }

    function checkAuthState() {
        if (currentUser) {
            document.getElementById('login-btn').style.display = 'none';
            document.getElementById('logout-btn').style.display = 'block';
            document.getElementById('user-info').style.display = 'flex';
            document.getElementById('user-name').textContent = currentUser.name;

            const avatarElement = document.getElementById('user-avatar');
            const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
            avatarElement.textContent = initials;
            
            if (document.getElementById('add-problem-section').style.display !== 'none') {
                document.getElementById('problem-form').style.display = 'block';
                document.getElementById('problem-login-required').style.display = 'none';
            }
            
            if (document.getElementById('problem-detail').style.display !== 'none') {
                document.getElementById('solution-form').style.display = 'block';
                document.getElementById('solution-login-required').style.display = 'none';
                document.getElementById('comment-form').style.display = 'block';
                document.getElementById('comment-login-required').style.display = 'none';
            }
            
            if (document.getElementById('profile-section').style.display !== 'none') {
                document.getElementById('profile-content').style.display = 'block';
                document.getElementById('profile-login-required').style.display = 'none';
            }
        } else {
            document.getElementById('login-btn').style.display = 'block';
            document.getElementById('logout-btn').style.display = 'none';
            document.getElementById('user-info').style.display = 'none';
            
            if (document.getElementById('add-problem-section').style.display !== 'none') {
                document.getElementById('problem-form').style.display = 'none';
                document.getElementById('problem-login-required').style.display = 'block';
            }
            
            if (document.getElementById('problem-detail').style.display !== 'none') {
                document.getElementById('solution-form').style.display = 'none';
                document.getElementById('solution-login-required').style.display = 'block';
                document.getElementById('comment-form').style.display = 'none';
                document.getElementById('comment-login-required').style.display = 'block';
            }
                       
            if (document.getElementById('profile-section').style.display !== 'none') {
                document.getElementById('profile-content').style.display = 'none';
                document.getElementById('profile-login-required').style.display = 'block';
            }
        }
    }

    // Функция удаления текущей задачи
    function deleteCurrentProblem() {
        if (currentProblemId) {
            deleteProblem(currentProblemId);
        }
    }

    // Функция показа предпросмотра задачи
    function showProblemPreview() {
        const title = document.getElementById('problem-title').value;
        const content = document.getElementById('problem-content').value;
        const tags = document.getElementById('problem-tags').value;
        const difficulty = document.getElementById('problem-difficulty').value;
        
        document.getElementById('preview-title').textContent = title || '(Без названия)';
        document.getElementById('preview-content').textContent = content || '(Содержание отсутствует)';
        
        const tagsContainer = document.getElementById('preview-tags');
        tagsContainer.innerHTML = '';
        if (tags) {
            tags.split(',').forEach(tag => {
                const tagEl = document.createElement('span');
                tagEl.className = 'tag';
                tagEl.textContent = tag.trim();
                tagsContainer.appendChild(tagEl);
            });
        }
        
        document.getElementById('preview-difficulty').textContent = `Сложность: ${difficulty}`;
        document.getElementById('preview-modal').style.display = 'flex';
        
        MathJax.Hub.Queue(["Typeset", MathJax.Hub, "preview-content"]);
    }

    // Функция скрытия предпросмотра
    function hideProblemPreview() {
        document.getElementById('preview-modal').style.display = 'none';
    }

    // Функция подсчета символов в описании
    function updateCharacterCount() {
        const textarea = document.getElementById('account-description');
        const countElement = document.getElementById('description-chars');
        const count = textarea.value.length;
        countElement.textContent = count;
        
        if (count > 100) {
            countElement.style.color = '#e74c3c';
        } else {
            countElement.style.color = '#7f8c8d';
        }
    }

    // Функция показа формы добавления задачи
    function showAddProblemForm() {
        document.getElementById('problems-list').style.display = 'none';
        document.getElementById('problem-detail').style.display = 'none';
        document.getElementById('pagination-container').style.display = 'none';
        document.getElementById('pagination-top-container').style.display = 'none';
        document.getElementById('add-problem-section').style.display = 'block';
        document.getElementById('profile-section').style.display = 'none';
        
        document.querySelector('.search-box').style.display = 'none';
        document.querySelector('.sort-options').style.display = 'none';
        
        if (currentUser) {
            document.getElementById('problem-form').style.display = 'block';
            document.getElementById('problem-login-required').style.display = 'none';
        } else {
            document.getElementById('problem-form').style.display = 'none';
            document.getElementById('problem-login-required').style.display = 'block';
        }
    }

    // Функция показа профиля
    function showProfile() {
        document.getElementById('problems-list').style.display = 'none';
        document.getElementById('problem-detail').style.display = 'none';
        document.getElementById('pagination-container').style.display = 'none';
        document.getElementById('pagination-top-container').style.display = 'none';
        document.getElementById('add-problem-section').style.display = 'none';
        document.getElementById('profile-section').style.display = 'block';
        
        document.querySelector('.search-box').style.display = 'none';
        document.querySelector('.sort-options').style.display = 'none';
        
        if (currentUser) {
            document.getElementById('profile-content').style.display = 'block';
            document.getElementById('profile-login-required').style.display = 'none';
            loadProfileData();
        } else {
            document.getElementById('profile-content').style.display = 'none';
            document.getElementById('profile-login-required').style.display = 'block';
        }
    }

    // Функция загрузки данных профиля
    async function loadProfileData() {
        if (!currentUser) return;
        
        // Обновляем данные пользователя из базы
        const freshUser = await forumDB.getUser(currentUser.id);
        if (freshUser) {
            currentUser = { ...currentUser, ...freshUser };
            localStorage.setItem('current_user', JSON.stringify(currentUser));
        }
        
        const avatarElement = document.getElementById('profile-avatar');
        const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
        avatarElement.textContent = initials;
        
        document.getElementById('profile-user-name').textContent = currentUser.name;
        
        const descriptionElement = document.getElementById('profile-description');
        if (currentUser.description) {
            descriptionElement.textContent = currentUser.description;
        } else {
            descriptionElement.textContent = 'Описание профиля не добавлено';
            descriptionElement.style.fontStyle = 'italic';
            descriptionElement.style.color = '#7f8c8d';
        }
        
        document.getElementById('account-description').value = currentUser.description || '';
        updateCharacterCount();
        
        const userData = users.find(u => u.id === currentUser.id);
        if (userData && userData.registration_date) {
            document.getElementById('profile-registration-date').textContent = userData.registration_date;
        } else {
            document.getElementById('profile-registration-date').textContent = 'недавно';
        }
        
        calculateUserStats();
        loadUserContent();
    }

    // Функция расчета статистики пользователя
    function calculateUserStats() {
        if (!currentUser) return;
        
        let problemsCount = 0;
        let solutionsCount = 0;
        let commentsCount = 0;
        let favoritesCount = 0;
        let bestSolutionsCount = 0;
        let likesProblems = 0;
        let likesSolutions = 0;
        let likesComments = 0;
        
        problems.forEach(problem => {
            if (problem.author_id === currentUser.id) {
                problemsCount++;
                likesProblems += problem.likes ? problem.likes.length : 0;
            }
            
            if (problem.solutions) {
                problem.solutions.forEach(solution => {
                    if (solution.author_id === currentUser.id) {
                        solutionsCount++;
                        likesSolutions += solution.likes ? solution.likes.length : 0;
                        if (problem.best_solution_id === solution.id && problem.author_id !== currentUser.id) {
                            bestSolutionsCount++;
                        }
                    }
                });
            }
            
            if (problem.comments) {
                problem.comments.forEach(comment => {
                    if (comment.author_id === currentUser.id) {
                        commentsCount++;
                        likesComments += comment.likes ? comment.likes.length : 0;
                    }
                });
            }
            
            if (problem.favorites && problem.favorites.includes(currentUser.id)) {
                favoritesCount++;
            }
        });
        
        document.getElementById('stat-problems').textContent = problemsCount;
        document.getElementById('stat-solutions').textContent = solutionsCount;
        document.getElementById('stat-comments').textContent = commentsCount;
        document.getElementById('stat-favorites').textContent = favoritesCount;
        document.getElementById('stat-best-solutions').textContent = bestSolutionsCount;
        document.getElementById('stat-likes-problems').textContent = likesProblems;
        document.getElementById('stat-likes-solutions').textContent = likesSolutions;
        document.getElementById('stat-likes-comments').textContent = likesComments;
    }

    // Функция загрузки контента пользователя
    function loadUserContent() {
        if (!currentUser) return;
        
        const problemsList = document.getElementById('profile-problems-list');
        const solutionsList = document.getElementById('profile-solutions-list');
        const commentsList = document.getElementById('profile-comments-list');
        const favoritesList = document.getElementById('profile-favorites-list');
        const bestSolutionsList = document.getElementById('profile-best-solutions-list');
        
        problemsList.innerHTML = '';
        solutionsList.innerHTML = '';
        commentsList.innerHTML = '';
        favoritesList.innerHTML = '';
        bestSolutionsList.innerHTML = '';
        
        // Задачи пользователя
        const userProblems = problems.filter(p => p.authorId === currentUser.id);
        if (userProblems.length > 0) {
            userProblems.forEach(problem => {
                const problemItem = document.createElement('div');
                problemItem.className = 'profile-list-item';
                problemItem.innerHTML = `
                    <a href="#" class="view-problem-from-profile" data-id="${problem.id}">${problem.title}</a>
                    <div class="problem-meta">
                        <span>${problem.date}</span>
                        <span>Лайков: ${problem.likes ? problem.likes.length : 0}</span>
                    </div>
                `;
                problemsList.appendChild(problemItem);
            });
        } else {
            problemsList.innerHTML = '<div class="empty-profile-list">Вы еще не создали ни одной задачи</div>';
        }
        
        // Решения пользователя
        let userSolutions = [];
        problems.forEach(problem => {
            if (problem.solutions) {
                problem.solutions.forEach(solution => {
                    if (solution.authorId === currentUser.id) {
                        userSolutions.push({
                            solution: solution,
                            problemId: problem.id,
                            problemTitle: problem.title
                        });
                    }
                });
            }
        });
        
        if (userSolutions.length > 0) {
            userSolutions.forEach(item => {
                const solutionItem = document.createElement('div');
                solutionItem.className = 'profile-list-item';
                solutionItem.innerHTML = `
                    <a href="#" class="view-problem-from-profile" data-id="${item.problemId}">К задаче: ${item.problemTitle}</a>
                    <div class="problem-meta">
                        <span>${item.solution.date}</span>
                        <span>Лайков: ${item.solution.likes ? item.solution.likes.length : 0}</span>
                    </div>
                `;
                solutionsList.appendChild(solutionItem);
            });
        } else {
            solutionsList.innerHTML = '<div class="empty-profile-list">Вы еще не добавили ни одного решения</div>';
        }
        
        // Комментарии пользователя
        let userComments = [];
        problems.forEach(problem => {
            if (problem.comments) {
                problem.comments.forEach(comment => {
                    if (comment.authorId === currentUser.id) {
                        userComments.push({
                            comment: comment,
                            problemId: problem.id,
                            problemTitle: problem.title
                        });
                    }
                });
            }
        });
        
        if (userComments.length > 0) {
            userComments.forEach(item => {
                const commentItem = document.createElement('div');
                commentItem.className = 'profile-list-item';
                commentItem.innerHTML = `
                    <a href="#" class="view-problem-from-profile" data-id="${item.problemId}">К задаче: ${item.problemTitle}</a>
                    <div class="problem-meta">
                        <span>${item.comment.date}</span>
                        <span>Лайков: ${item.comment.likes ? item.comment.likes.length : 0}</span>
                    </div>
                `;
                commentsList.appendChild(commentItem);
            });
        } else {
            commentsList.innerHTML = '<div class="empty-profile-list">Вы еще не оставили ни одного комментария</div>';
        }
        
        // Избранные задачи пользователя
        const userFavorites = problems.filter(problem => 
            problem.favorites && problem.favorites.includes(currentUser.id)
        );
        
        if (userFavorites.length > 0) {
            userFavorites.forEach(problem => {
                const favoriteItem = document.createElement('div');
                favoriteItem.className = 'profile-list-item';
                favoriteItem.innerHTML = `
                    <a href="#" class="view-problem-from-profile" data-id="${problem.id}">${problem.title}</a>
                    <div class="problem-meta">
                        <span>${problem.date}</span>
                        <span>Автор: ${problem.author}</span>
                    </div>
                `;
                favoritesList.appendChild(favoriteItem);
            });
        } else {
            favoritesList.innerHTML = '<div class="empty-profile-list">У вас нет избранных задач</div>';
        }
        
        // Лучшие решения, отмеченные пользователем
        let userBestSolutions = [];
        problems.forEach(problem => {
            if (problem.bestSolutionId && problem.authorId !== currentUser.id) {
                const bestSolution = problem.solutions?.find(s => s.id === problem.bestSolutionId);
                if (bestSolution && bestSolution.authorId === currentUser.id) {
                    userBestSolutions.push({
                        solution: bestSolution,
                        problemId: problem.id,
                        problemTitle: problem.title,
                        problemAuthor: problem.author
                    });
                }
            }
        });
        
        if (userBestSolutions.length > 0) {
            userBestSolutions.forEach(item => {
                const bestSolutionItem = document.createElement('div');
                bestSolutionItem.className = 'profile-list-item';
                bestSolutionItem.innerHTML = `
                    <a href="#" class="view-problem-from-profile" data-id="${item.problemId}">К задаче: ${item.problemTitle}</a>
                    <div class="problem-meta">
                        <span>Автор решения: ${item.solution.author}</span>
                        <span>Лайков: ${item.solution.likes ? item.solution.likes.length : 0}</span>
                    </div>
                `;
                bestSolutionsList.appendChild(bestSolutionItem);
            });
        } else {
            bestSolutionsList.innerHTML = '<div class="empty-profile-list">У вас нет лучших решений</div>';
        }
        
        document.querySelectorAll('.view-problem-from-profile').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const problemId = parseInt(this.getAttribute('data-id'));
                showProblemDetail(problemId);
                setActiveNav(document.getElementById('nav-problems'));
            });
        });
    }

    // Вспомогательная функция для установки активной навигации
    function setActiveNav(activeNav) {
        document.querySelectorAll('nav ul li a').forEach(nav => {
            nav.classList.remove('active');
        });
        activeNav.classList.add('active');
    }

    // Функция показа сообщения об успехе
    function showSuccessMessage(message) {
        const successMessage = document.getElementById('success-message');
        successMessage.querySelector('span').textContent = message;
        successMessage.style.display = 'flex';
        
        setTimeout(() => {
            successMessage.style.display = 'none';
        }, 4000);
    }

    // Показать модальное окно FAQ
    function showFaqModal() {
        document.getElementById('faq-modal').style.display = 'flex';
    }

    // Скрыть модальное окно FAQ
    function hideFaqModal() {
        document.getElementById('faq-modal').style.display = 'none';
    }

    // Проверка, является ли пользователь администратором
    function isAdmin(user) {
        return user && user.name === "Сайт MathProj";
    }

    // Установка метода сортировки
    function setSortMethod(method) {
        currentSort = method;
        showLoading();
        document.querySelectorAll('.sort-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        if (method === 'date') {
            document.getElementById('sort-by-date').classList.add('active');
        } else {
            document.getElementById('sort-by-popularity').classList.add('active');
        }
        
        currentPage = 1;
        loadProblems();
        hideLoading();
    }

    // Функция отображения деталей задачи
    async function showProblemDetail(problemId) {
        showLoading();
        
        try {
            const problem = await forumDB.getProblem(problemId);
            
            if (problem) {
                currentProblemId = problemId;
                
                // Обновляем локальную копию
                const localProblemIndex = problems.findIndex(p => p.id === problemId);
                if (localProblemIndex !== -1) {
                    problems[localProblemIndex] = { ...problems[localProblemIndex], ...problem };
                } else {
                    problems.push(problem);
                }
                
                // Для совместимости
                problem.authorId = problem.author_id;
                problem.bestSolutionId = problem.best_solution_id;
                problem.date = problem.created_at ? new Date(problem.created_at).toLocaleDateString('ru-RU') : problem.date;
                
                if (problem.solutions) {
                    problem.solutions.forEach(solution => {
                        solution.authorId = solution.author_id;
                    });
                }
                
                if (problem.comments) {
                    problem.comments.forEach(comment => {
                        comment.authorId = comment.author_id;
                    });
                }
                
                document.getElementById('detail-title').textContent = problem.title;
                document.getElementById('detail-content').textContent = problem.content;
                document.getElementById('detail-author').textContent = `Автор: ${problem.author}`;
                document.getElementById('detail-date').textContent = `Дата: ${problem.date || 'Неизвестно'}`;
                
                const tagsContainer = document.getElementById('detail-tags');
                tagsContainer.innerHTML = '';
                
                if (problem.tags) {
                    problem.tags.forEach(tag => {
                        const tagEl = document.createElement('span');
                        tagEl.className = 'tag';
                        tagEl.textContent = tag;
                        tagsContainer.appendChild(tagEl);
                    });
                }
                
                const difficultyTag = document.createElement('span');
                difficultyTag.className = 'tag';
                difficultyTag.textContent = `Сложность: ${problem.difficulty}`;
                tagsContainer.appendChild(difficultyTag);
                
                const imagesContainer = document.getElementById('detail-images');
                imagesContainer.innerHTML = '';
                
                if (problem.images && problem.images.length > 0) {
                    problem.images.forEach(image => {
                        const img = document.createElement('img');
                        img.src = image.data;
                        img.className = 'attached-image';
                        img.onclick = function() {
                            openImageModal(image.data);
                        };
                        imagesContainer.appendChild(img);
                    });
                }
                
                const favoriteBtn = document.getElementById('toggle-favorite');
                const isFavorited = currentUser && problem.favorites && problem.favorites.includes(currentUser.id);
                favoriteBtn.className = `favorite-btn ${isFavorited ? 'favorited' : ''}`;
                favoriteBtn.innerHTML = `<i class="${isFavorited ? 'fas' : 'far'} fa-star"></i>`;
                favoriteBtn.title = isFavorited ? 'Удалить из избранного' : 'Добавить в избранное';
                
                favoriteBtn.onclick = function() {
                    if (!currentUser) {
                        showAuthModal();
                        return;
                    }
                    toggleFavorite(problemId);
                };
                    
                const reactionsContainer = document.getElementById('problem-reactions');
                reactionsContainer.innerHTML = '';
                
                const userLiked = currentUser && problem.likes && problem.likes.includes(currentUser.id);
                const userDisliked = currentUser && problem.dislikes && problem.dislikes.includes(currentUser.id);
                
                const likeBtn = document.createElement('button');
                likeBtn.className = `reaction-btn ${userLiked ? 'liked' : ''}`;
                likeBtn.setAttribute('data-type', 'like');
                likeBtn.setAttribute('data-id', problem.id);
                likeBtn.innerHTML = `<i class="fas fa-thumbs-up"></i> <span class="reaction-count">${problem.likes ? problem.likes.length : 0}</span>`;
                
                const dislikeBtn = document.createElement('button');
                dislikeBtn.className = `reaction-btn ${userDisliked ? 'disliked' : ''}`;
                dislikeBtn.setAttribute('data-type', 'dislike');
                dislikeBtn.setAttribute('data-id', problem.id);
                dislikeBtn.innerHTML = `<i class="fas fa-thumbs-down"></i> <span class="reaction-count">${problem.dislikes ? problem.dislikes.length : 0}</span>`;
                
                likeBtn.addEventListener('click', function() {
                    if (!currentUser) {
                        showAuthModal();
                        return;
                    }
                    handleReaction('problem', problem.id, null, null, 'like');
                });
                
                dislikeBtn.addEventListener('click', function() {
                    if (!currentUser) {
                        showAuthModal();
                        return;
                    }
                    handleReaction('problem', problem.id, null, null, 'dislike');
                });
                
                reactionsContainer.appendChild(likeBtn);
                reactionsContainer.appendChild(dislikeBtn);
                
                if (currentUser && (problem.author_id === currentUser.id || isAdmin(currentUser))) {
                    document.getElementById('problem-actions').style.display = 'block';
                } else {
                    document.getElementById('problem-actions').style.display = 'none';
                }
                
                const solutionsList = document.getElementById('solutions-list');
                solutionsList.innerHTML = '';
                
                if (problem.solutions && problem.solutions.length > 0) {
                    problem.solutions.forEach((solution, index) => {
                        const userLikedSolution = currentUser && solution.likes && solution.likes.includes(currentUser.id);
                        const userDislikedSolution = currentUser && solution.dislikes && solution.dislikes.includes(currentUser.id);
                        const isBestSolution = problem.best_solution_id === solution.id;
                        
                        const solutionEl = document.createElement('div');
                        solutionEl.className = `solution ${isBestSolution ? 'best-solution' : ''}`;
                        
                        const canDeleteSolution = currentUser && (solution.author_id === currentUser.id || isAdmin(currentUser));
                        const canMarkAsBest = currentUser && problem.author_id === currentUser.id;
                        
                        let solutionImages = '';
                        if (solution.images && solution.images.length > 0) {
                            solutionImages = `<div class="attached-images">`;
                            solution.images.forEach(image => {
                                solutionImages += `<img src="${image.data}" class="attached-image" onclick="openImageModal('${image.data}')">`;
                            });
                            solutionImages += `</div>`;
                        }
                        
                        solutionEl.innerHTML = `
                            ${isBestSolution ? 
                                `<div class="best-solution-badge">
                                    <i class="fas fa-crown"></i> Лучшее решение
                                </div>` : ''}
                            ${canDeleteSolution ? 
                                `<button class="delete-btn delete-solution" data-index="${index}">
                                    <i class="fas fa-times"></i>
                                </button>` : ''}
                            <p>${solution.content}</p>
                            ${solutionImages}
                            <div class="problem-meta">
                                <span>ID задачи: ${problem.id}</span>
                                <span>Автор: ${solution.author}</span>
                                <span>Дата: ${solution.date || (solution.created_at ? new Date(solution.created_at).toLocaleDateString('ru-RU') : 'Неизвестно')}</span>
                            </div>
                            <div class="reactions">
                                <button class="reaction-btn ${userLikedSolution ? 'liked' : ''}" data-type="like" data-problem="${problem.id}" data-index="${index}">
                                    <i class="fas fa-thumbs-up"></i>
                                    <span class="reaction-count">${solution.likes ? solution.likes.length : 0}</span>
                                </button>
                                <button class="reaction-btn ${userDislikedSolution ? 'disliked' : ''}" data-type="dislike" data-problem="${problem.id}" data-index="${index}">
                                    <i class="fas fa-thumbs-down"></i>
                                    <span class="reaction-count">${solution.dislikes ? solution.dislikes.length : 0}</span>
                                </button>
                                ${canMarkAsBest ? 
                                    `<button class="best-solution-btn toggle-best-solution-btn" data-solution-id="${solution.id}">
                                        <i class="fas fa-crown"></i> ${isBestSolution ? 'Снять отметку' : 'Отметить как лучшее'}
                                    </button>` : ''}
                            </div>
                        `;
                        solutionsList.appendChild(solutionEl);
                    });
                } else {
                    solutionsList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-lightbulb"></i>
                            <p>Пока нет решений. Будьте первым, кто предложит решение!</p>
                        </div>
                    `;
                }
                
                const commentsList = document.getElementById('comments-list');
                commentsList.innerHTML = '';
                
                if (problem.comments && problem.comments.length > 0) {
                    problem.comments.forEach((comment, index) => {
                        const userLikedComment = currentUser && comment.likes && comment.likes.includes(currentUser.id);
                        const userDislikedComment = currentUser && comment.dislikes && comment.dislikes.includes(currentUser.id);
                        
                        const commentEl = document.createElement('div');
                        commentEl.className = 'comment';
                        
                        const canDeleteComment = currentUser && (comment.author_id === currentUser.id || isAdmin(currentUser));
                        
                        let commentImages = '';
                        if (comment.images && comment.images.length > 0) {
                            commentImages = `<div class="attached-images">`;
                            comment.images.forEach(image => {
                                commentImages += `<img src="${image.data}" class="attached-image" onclick="openImageModal('${image.data}')">`;
                            });
                            commentImages += `</div>`;
                        }
                        
                        commentEl.innerHTML = `
                            ${canDeleteComment ? 
                                `<button class="delete-btn delete-comment" data-index="${index}">
                                    <i class="fas fa-times"></i>
                                </button>` : ''}
                            <div class="comment-meta">
                                <span>Автор: ${comment.author}</span>
                                <span>Дата: ${comment.date || (comment.created_at ? new Date(comment.created_at).toLocaleDateString('ru-RU') : 'Неизвестно')}</span>
                            </div>
                            <p>${comment.content}</p>
                            ${commentImages}
                            <div class="reactions">
                                <button class="reaction-btn ${userLikedComment ? 'liked' : ''}" data-type="like" data-problem="${problem.id}" data-index="${index}">
                                    <i class="fas fa-thumbs-up"></i>
                                    <span class="reaction-count">${comment.likes ? comment.likes.length : 0}</span>
                                </button>
                                <button class="reaction-btn ${userDislikedComment ? 'disliked' : ''}" data-type="dislike" data-problem="${problem.id}" data-index="${index}">
                                    <i class="fas fa-thumbs-down"></i>
                                    <span class="reaction-count">${comment.dislikes ? comment.dislikes.length : 0}</span>
                                </button>
                            </div>
                        `;
                        commentsList.appendChild(commentEl);
                    });
                } else {
                    commentsList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-comments"></i>
                            <p>Пока нет комментариев. Будьте первым, кто оставит комментарий!</p>
                        </div>
                    `;
                }
                
                if (currentUser) {
                    document.getElementById('solution-form').style.display = 'block';
                    document.getElementById('solution-login-required').style.display = 'none';
                    document.getElementById('comment-form').style.display = 'block';
                    document.getElementById('comment-login-required').style.display = 'none';
                } else {
                    document.getElementById('solution-form').style.display = 'none';
                    document.getElementById('solution-login-required').style.display = 'block';
                    document.getElementById('comment-form').style.display = 'none';
                    document.getElementById('comment-login-required').style.display = 'block';
                }
                
                document.getElementById('problems-list').style.display = 'none';
                document.getElementById('problem-detail').style.display = 'block';
                document.getElementById('pagination-container').style.display = 'none';
                document.getElementById('pagination-top-container').style.display = 'none';
                document.getElementById('add-problem-section').style.display = 'none';
                document.getElementById('profile-section').style.display = 'none';
            }
        } catch (error) {
            console.error('Ошибка при загрузке задачи:', error);
            alert('Ошибка при загрузке задачи.');
        }
        
        hideLoading();
    }

    // Функция открытия модального окна с изображением
    function openImageModal(imageData) {
        document.getElementById('modal-image').src = imageData;
        document.getElementById('image-modal').style.display = 'block';
    }

    // Настройка обработчиков для загрузки изображений
    function setupImageUploadHandlers() {
        const problemImageInput = document.getElementById('problem-images');
        problemImageInput.addEventListener('change', function() {
            handleImageSelection(this, 'problem');
        });
        
        const solutionImageInput = document.getElementById('solution-images');
        solutionImageInput.addEventListener('change', function() {
            handleImageSelection(this, 'solution');
        });
        
        const commentImageInput = document.getElementById('comment-images');
        commentImageInput.addEventListener('change', function() {
            handleImageSelection(this, 'comment');
        });
    }

    // Обработка выбора изображений
    function handleImageSelection(input, type) {
        const files = input.files;
        const fileNamesElement = document.getElementById(`${type}-file-names`);
        const previewContainer = document.getElementById(`${type}-image-previews`);
        
        previewContainer.innerHTML = '';
        
        if (files.length > MAX_IMAGES_PER_ITEM) {
            alert(`Можно загрузить не более ${MAX_IMAGES_PER_ITEM} изображений`);
            input.value = '';
            fileNamesElement.textContent = '';
            return;
        }
        
        let validFiles = [];
        
        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            
            if (!file.type.match('image/jpeg') && !file.type.match('image/png')) {
                alert(`Файл "${file.name}" не является изображением JPEG или PNG`);
                continue;
            }
            
            if (file.size > MAX_IMAGE_SIZE) {
                alert(`Файл "${file.name}" слишком большой. Максимальный размер: 2 МБ.`);
                continue;
            }
            
            validFiles.push(file);
        }
        
        if (validFiles.length === 0) {
            input.value = '';
            fileNamesElement.textContent = '';
            previewContainer.innerHTML = '';
            return;
        }
        
        const dataTransfer = new DataTransfer();
        validFiles.forEach(file => dataTransfer.items.add(file));
        input.files = dataTransfer.files;
        
        if (validFiles.length > 0) {
            fileNamesElement.textContent = `Выбрано файлов: ${validFiles.length}`;
        } else {
            fileNamesElement.textContent = '';
        }
        
        for (let i = 0; i < validFiles.length; i++) {
            const file = validFiles[i];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    if (img.width > MAX_IMAGE_DIMENSION || img.height > MAX_IMAGE_DIMENSION) {
                        alert(`Изображение "${file.name}" слишком большое. Максимальный размер: ${MAX_IMAGE_DIMENSION}x${MAX_IMAGE_DIMENSION} пикселей.`);
                        validFiles = validFiles.filter(f => f !== file);
                        const newDataTransfer = new DataTransfer();
                        validFiles.forEach(f => newDataTransfer.items.add(f));
                        input.files = newDataTransfer.files;
                        
                        if (validFiles.length === 0) {
                            fileNamesElement.textContent = '';
                            previewContainer.innerHTML = '';
                        } else {
                            fileNamesElement.textContent = `Выбрано файлов: ${validFiles.length}`;
                        }
                        return;
                    }
                    
                    const preview = document.createElement('div');
                    preview.className = 'image-preview';
                    
                    const previewImg = document.createElement('img');
                    previewImg.src = e.target.result;
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-image';
                    removeBtn.innerHTML = '×';
                    removeBtn.addEventListener('click', function() {
                        preview.remove();
                        const updatedFiles = Array.from(input.files).filter(f => f !== file);
                        const dt = new DataTransfer();
                        updatedFiles.forEach(f => dt.items.add(f));
                        input.files = dt.files;
                        
                        if (updatedFiles.length === 0) {
                            fileNamesElement.textContent = '';
                        } else {
                            fileNamesElement.textContent = `Выбрано файлов: ${updatedFiles.length}`;
                        }
                    });
                    
                    preview.appendChild(previewImg);
                    preview.appendChild(removeBtn);
                    previewContainer.appendChild(preview);
                };
                img.src = e.target.result;
            };
            
            reader.onerror = function() {
                alert(`Ошибка при чтении файла ${file.name}`);
            };
            
            reader.readAsDataURL(file);
        }
    }

    // Функция чтения файлов изображений с оптимизацией
    function readImageFiles(files) {
        return new Promise((resolve) => {
            const images = [];
            let filesProcessed = 0;
            
            const validFiles = Array.from(files).filter(file => file.size <= MAX_IMAGE_SIZE);
            
            if (validFiles.length === 0) {
                resolve([]);
                return;
            }
            
            for (let i = 0; i < validFiles.length; i++) {
                const file = validFiles[i];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        let width = img.width;
                        let height = img.height;
                        
                        if (width > MAX_IMAGE_DIMENSION || height > MAX_IMAGE_DIMENSION) {
                            if (width > height) {
                                height = Math.round(height * MAX_IMAGE_DIMENSION / width);
                                width = MAX_IMAGE_DIMENSION;
                            } else {
                                width = Math.round(width * MAX_IMAGE_DIMENSION / height);
                                height = MAX_IMAGE_DIMENSION;
                            }
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        const optimizedDataUrl = canvas.toDataURL('image/jpeg', 0.8);
                        
                        images.push({
                            name: file.name,
                            data: optimizedDataUrl,
                            width: width,
                            height: height
                        });
                        
                        filesProcessed++;
                        if (filesProcessed === validFiles.length) {
                            resolve(images);
                        }
                    };
                    
                    img.onerror = function() {
                        console.error('Ошибка загрузки изображения');
                        filesProcessed++;
                        if (filesProcessed === validFiles.length) {
                            resolve(images);
                        }
                    };
                    
                    img.src = e.target.result;
                };
                
                reader.onerror = function() {
                    console.error('Ошибка чтения файла');
                    filesProcessed++;
                    if (filesProcessed === validFiles.length) {
                        resolve(images);
                    }
                };
                
                reader.readAsDataURL(file);
            }
        });
    }

    // Функция для вставки текста в текущую позицию курсора
    function insertAtCursor(textarea, text) {
        const start = textarea.selectionStart;
        const end = textarea.selectionEnd;
        const before = textarea.value.substring(0, start);
        const after = textarea.value.substring(end, textarea.value.length);
        
        textarea.value = before + text + after;
        textarea.selectionStart = start + text.length;
        textarea.selectionEnd = start + text.length;
        
        const event = new Event('input', { bubbles: true });
        textarea.dispatchEvent(event);
    }

    // Функция обновления предпросмотра LaTeX
    function updateLatexPreview() {
    try {
        const content = document.getElementById('problem-content').value;
        const preview = document.getElementById('latex-preview');
        
        if (!preview) {
            console.log('Элемент предпросмотра LaTeX не найден');
            return;
        }
        
        const inlineRegex = /\$([^$]+)\$/g;
        const displayRegex = /\$\$([^$]+)\$\$/g;
        
        let previewContent = '';
        
        if (content.match(inlineRegex) || content.match(displayRegex)) {
            previewContent = content
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/\n/g, '<br>');
            
            previewContent = previewContent
                .replace(/\$([^$]+)\$/g, '<span class="math">\\($1\\)</span>')
                .replace(/\$\$([^$]+)\$\$/g, '<div class="math">\\[$1\\]</div>');
        } else {
            previewContent = '<em>Введите формулу, используя символы $...$ для встроенных формул или $$...$$ для вынесенных формул</em>';
        }
        
        preview.innerHTML = previewContent;
        
        MathJax.Hub.Queue(["Typeset", MathJax.Hub, preview]);
    } catch (error) {
        console.error('LaTeX rendering error:', error);
        preview.innerHTML = '<em>Ошибка в формуле LaTeX</em>';
    }
}


function showErrorMessage(message) {
    const errorMessage = document.getElementById('success-message');
    errorMessage.querySelector('span').textContent = message;
    errorMessage.style.display = 'flex';
    errorMessage.style.backgroundColor = '#f8d7da';
    errorMessage.style.color = '#721c24';
    
    setTimeout(() => {
        errorMessage.style.display = 'none';
        errorMessage.style.backgroundColor = '#d4edda';
        errorMessage.style.color = '#155724';
    }, 4000);
}

  
    // Функция проверки сложности пароля
    function validatePassword(password) {
        // Более гибкая проверка пароля
        const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d.]{8,}$/;
        return passwordRegex.test(password);
    }

    // Функции для индикатора загрузки
    function showLoading() {
        document.getElementById('loading-overlay').style.display = 'flex';
    }

    function hideLoading() {
        document.getElementById('loading-overlay').style.display = 'none';
    }

    // Настройка счетчиков символов
    function setupCharacterCounters() {
            // Обработчик для имени при регистрации
            document.getElementById('register-name').addEventListener('input', function() {
                const count = this.value.length;
                const countElement = document.getElementById('register-name-chars');
                countElement.textContent = count;
                
                if (count > 40) {
                    countElement.classList.add('error');
                } else {
                    countElement.classList.remove('error');
                }
            });
            
            // Обработчик для названия задачи
            document.getElementById('problem-title').addEventListener('input', function() {
                const count = this.value.length;
                let validationElement = document.getElementById('problem-title-validation');
                
                if (!validationElement) {
                    validationElement = document.createElement('div');
                    validationElement.id = 'problem-title-validation';
                    validationElement.className = 'character-count';
                    this.parentNode.appendChild(validationElement);
                }
                
                validationElement.textContent = `${count}/200 символов`;
                
                if (count < 5 || count > 200) {
                    validationElement.classList.add('error');
                } else {
                    validationElement.classList.remove('error');
                }
            });
            
            // Обработчик для условия задачи
document.getElementById('problem-content').addEventListener('input', function() {
    const count = this.value.length;
    const validationElement = document.getElementById('problem-content-validation');
    
    validationElement.innerHTML = `<span>${count}</span>/2000 символов`;
    
    if (count < 10 || count > 2000) {
        validationElement.classList.add('error');
    } else {
        validationElement.classList.remove('error');
    }
});
            
            // Обработчик для решения
            document.getElementById('solution-content').addEventListener('input', function() {
                const count = this.value.length;
                let validationElement = document.getElementById('solution-content-validation');
                
                if (!validationElement) {
                    validationElement = document.createElement('div');
                    validationElement.id = 'solution-content-validation';
                    validationElement.className = 'character-count';
                    this.parentNode.appendChild(validationElement);
                }
                
                validationElement.textContent = `${count}/3000 символов`;
                
                if (count < 10 || count > 3000) {
                    validationElement.classList.add('error');
                } else {
                    validationElement.classList.remove('error');
                }
            });
            
            // Обработчик для комментария
            document.getElementById('comment-content').addEventListener('input', function() {
                const count = this.value.length;
                let validationElement = document.getElementById('comment-content-validation');
                
                if (!validationElement) {
                    validationElement = document.createElement('div');
                    validationElement.id = 'comment-content-validation';
                    validationElement.className = 'character-count';
                    this.parentNode.appendChild(validationElement);
                }
                
                validationElement.textContent = `${count}/3000 символов`;
                
                if (count < 10 || count > 3000) {
                    validationElement.classList.add('error');
                } else {
                    validationElement.classList.remove('error');
                }
            });
            
            // Обработчик для тегов
            document.getElementById('problem-tags').addEventListener('input', function() {
                const tags = this.value.split(',').map(tag => tag.trim()).filter(tag => tag !== '');
                let validationElement = document.getElementById('problem-tags-validation');
                
                if (!validationElement) {
                    validationElement = document.createElement('div');
                    validationElement.id = 'problem-tags-validation';
                    validationElement.className = 'character-count';
                    this.parentNode.appendChild(validationElement);
                }
                
                let error = '';
                
                if (tags.length > 10) {
                    error = 'Можно указать не более 10 тегов. ';
                }
                
                for (const tag of tags) {
                    if (tag.length > 30) {
                        error += 'Каждый тег должен быть не длиннее 30 символов. ';
                        break;
                    }
                }
                
                validationElement.textContent = error || `${tags.length}/10 тегов`;
                
                if (error) {
                    validationElement.classList.add('error');
                } else {
                    validationElement.classList.remove('error');
                }
            });
        }
</script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 40px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50, #4a69bd);
            color: white;
            padding: 25px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }
        
        header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        nav {
            background: linear-gradient(90deg, #4a69bd 0%, #6a89cc 100%);
            padding: 15px 0;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        nav ul {
            display: flex;
            justify-content: center;
            list-style: none;
            flex-wrap: wrap;
        }
        
        nav ul li {
            margin: 5px 15px;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 30px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }
        
        nav ul li a i {
            margin-right: 8px;
        }
        
        nav ul li a:hover, nav ul li a.active {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .main-content > div:last-child {
            width: 100%;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            padding: 25px;
            margin-bottom: 25px;
            transition: transform 0.3s;
            width: 100%;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .problems-list {
            min-height: 500px;
        }
        
        .problem {
            border-bottom: 1px solid #eee;
            padding: 20px 0;
            position: relative;
        }
        
        .problem:last-child {
            border-bottom: none;
        }
        
        .problem h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.4rem;
        }
        
        .problem p {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .problem-meta {
            display: flex;
            justify-content: space-between;
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(135deg, #4a69bd 0%, #6a89cc 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 105, 189, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        
        .btn-sm {
            padding: 8px 15px;
            font-size: 0.9rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            border-color: #4a69bd;
            outline: none;
        }
        
        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .comments {
            margin-top: 25px;
        }
        
        .comment {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #4a69bd;
            position: relative;
        }
        
        .comment-meta {
            display: flex;
            justify-content: space-between;
            color: #7f8c8d;
            font-size: 0.85rem;
            margin-bottom: 8px;
        }
        
        .solution {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            position: relative;
        }
        
        .solution.best-solution {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.3);
        }
        
        .best-solution-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ffc107;
            color: #333;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
        }
        
        .best-solution-badge i {
            margin-right: 5px;
        }
        
        .tag {
            display: inline-block;
            background: linear-gradient(135deg, #6a89cc 0%, #4a69bd 100%);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        .math {
            font-family: 'TIMES NEW ROMAN', Times, serif;
            font-style: italic;
            background-color: #f8f9fa;
            padding: 2px 5px;
            border-radius: 4px;
        }
        
        .success-message {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            align-items: center;
        }
        
        .success-message i {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .difficulty-easy {
            color: #27ae60;
        }
        
        .difficulty-medium {
            color: #f39c12;
        }
        
        .difficulty-hard {
            color: #e74c3c;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 0;
            color: #7f8c8d;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #bdc3c7;
        }
        
        .counter {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            text-align: center;
        }
        
        .counter-item {
            padding: 15px;
        }
        
        .counter-number {
            font-size: 2.2rem;
            font-weight: 700;
            color: #4a69bd;
        }
        
        .counter-text {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .search-box {
            display: flex;
            margin-bottom: 20px;
        }
        
        .search-box input {
            flex-grow: 1;
            padding: 12px 10px;
            border: 2px solid #ddd;
            border-radius: 30px 0 0 30px;
            font-size: 1rem;
        }
        
        .search-box button {
            border-radius: 0 30px 30px 0;
        }
        
        .section-title {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .section-title i {
            margin-right: 10px;
            font-size: 1.5rem;
        }

        /* Новые стили для системы аккаунтов */
        .user-section {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            color: white;
            margin-right: 15px;
        }
        
        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6a89cc, #4a69bd);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            font-size: 18px;
        }
        
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .auth-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .auth-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
            color: #7f8c8d;
            transition: all 0.3s;
        }
        
        .auth-tab.active {
            color: #4a69bd;
            border-bottom: 3px solid #4a69bd;
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .auth-switch {
            margin-top: 20px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .auth-switch a {
            color: #4a69bd;
            cursor: pointer;
            text-decoration: underline;
        }
        
        .login-required {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }
        
        .login-required .btn {
            margin-top: 15px;
        }
        
        /* Стили для кнопок удаления */
        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: transparent;
            border: none;
            color: #e74c3c;
            cursor: pointer;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .delete-btn:hover {
            opacity: 1;
        }
        
        .problem-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        /* Стили для реакций (лайк/дизлайк) */
        .reactions {
            display: flex;
            align-items: center;
            margin-top: 10px;
            gap: 10px;
        }
        
        .reaction-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            padding: 5px 10px;
            border-radius: 20px;
            transition: all 0.3s;
        }
        
        .reaction-btn:hover {
            background-color: #f0f0f0;
        }
        
        .reaction-btn.liked {
            color: #4a69bd;
        }
        
        .reaction-btn.disliked {
            color: #e74c3c;
        }
        
        .reaction-count {
            margin-left: 5px;
            font-size: 0.9rem;
        }

        /* Новые стили для загрузки изображений */
        .image-upload {
            margin: 15px 0;
        }
        
        .image-upload-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .image-preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .image-preview {
            position: relative;
            width: 100px;
            height: 100px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-preview .remove-image {
            position: absolute;
            top: 2px;
            right: 2px;
            background: rgba(231, 76, 60, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .attached-images {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .attached-image {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .attached-image:hover {
            transform: scale(1.05);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            overflow: auto;
        }
        
        .modal-content {
            display: block;
            margin: auto;
            max-width: 90%;
            max-height: 90%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
        }
        
        .file-input-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }
        
        .file-input-button {
            background: linear-gradient(135deg, #4a69bd 0%, #6a89cc 100%);
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            display: inline-block;
            cursor: pointer;
        }
        
        .file-input-button:hover {
            background: linear-gradient(135deg, #405a8d 0%, #5a79bc 100%);
        }
        
        .file-name {
            margin-left: 10px;
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        /* Стили для сортировки */
        .sort-options {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .sort-btn {
            background: linear-gradient(135deg, #6a89cc 0%, #4a69bd 100%);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            transition: all 0.3s;
        }
        
        .sort-btn i {
            margin-right: 5px;
        }
        
        .sort-btn.active {
            background: linear-gradient(135deg, #4a69bd 0%, #2c3e50 100%);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        
        .sort-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 105, 189, 0.4);
        }

        /* Стили для пагинации */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            gap: 5px;
        }
        
        .page-numbers {
            display: flex;
            gap: 5px;
        }
        
        .pagination-btn {
            background: #f0f0f0;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 40px;
        }
        
        .pagination-btn:hover:not(:disabled) {
            background: #e0e0e0;
        }
        
        .pagination-btn.active {
            background: #4a69bd;
            color: white;
            border-color: #4a69bd;
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .pagination-ellipsis {
            padding: 8px 5px;
            color: #7f8c8d;
        }
        
        .page-info {
            text-align: center;
            margin-bottom: 10px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        /* Темная тема для пагинации */
        body.dark-theme .pagination-btn {
            background: #4a5568;
            border-color: #2d3748;
            color: #e6e6e6;
        }
        
        body.dark-theme .pagination-btn:hover:not(:disabled) {
            background: #5a6578;
        }
        
        body.dark-theme .pagination-btn.active {
            background: #6a89cc;
            border-color: #6a89cc;
        }
        
        body.dark-theme .pagination-ellipsis {
            color: #a0aec0;
        }
        
        body.dark-theme .page-info {
            color: #a0aec0;
        }

        /* Новые стили для FAQ модального окна */
        .faq-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .faq-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 100%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
        }
        
        .faq-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        
        .faq-header h2 {
            color: #587ca0;
        }
        
        .close-faq {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .faq-item {
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        
        .faq-question {
            font-weight: 600;
            color: #587ca0;
            margin-bottom: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .faq-answer {
            display: none;
            color: #555;
            line-height: 1.6;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 6px;
            margin-top: 8px;
        }
        
        .vscode-window-container {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #1e1e1e;
            font-family: "Fira Code", monospace;
        }

        .vscode-window {
            width: 100%;
            height: 100%;
            background: #1e1e2f;
            border-radius: 10px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid #333;  
        }

        .vscode-window .title-bar {
            height: 32px;
            background: #2c2c3e;
            display: flex;
            align-items: center;
            padding: 0 12px;
            color: #ccc;
            font-size: 0.85em;
        }

        .vscode-window .window-controls {
            margin-left: auto;
            display: flex;
            gap: 8px;
        }

        .vscode-window .window-controls div.close,
        .vscode-window .window-controls div.minimize,
        .vscode-window .window-controls div.maximize {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .vscode-window .window-controls div.close:hover,
        .vscode-window .window-controls div.minimize:hover,
        .vscode-window .window-controls div.maximize:hover {
            transform: scale(1.2);
        }
        
        .vscode-window .close {
            background: #ff5f56;
        }
        
        .vscode-window .minimize {
            background: #ffbd2e;
        }
        
        .vscode-window .maximize {
            background: #27c93f;
        }

        .vscode-window .tabs {
            display: flex;
            background: #252536;
            border-bottom: 1px solid #444;
        }

        .vscode-window .tabs label.l {
            padding: 8px 18px;
            color: #ccc;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.2s, color 0.2s;
        }

        .vscode-window .tabs label.l:hover {
            background: #2c2c3e;
            color: #fff;
        }

        .vscode-window input.i[name="tab"] {
            display: none;
        }

        .vscode-window #tab-html:checked ~ .tabs label.l[for="tab-html"],
        .vscode-window #tab-css:checked ~ .tabs label.l[for="tab-css"],
        .vscode-window #tab-js:checked ~ .tabs label.l[for="tab-js"] {
            background: #1e1e2f;
            color: #fff;
            border-bottom: 2px solid #007acc;
        }

        .vscode-window .code-panel {
            flex: 1;
            background: #1e1e2f;
            color: #d4d4d4;
            padding: 15px;
            font-family: "Fira Code", monospace;
            font-size: 0.9em;
            overflow-y: auto;
            line-height: 1.4em;
        }

        .vscode-window .panel {
            display: none;
        }

        .vscode-window #tab-html:checked ~ .code-panel #html-panel,
        .vscode-window #tab-css:checked ~ .code-panel #css-panel,
        .vscode-window #tab-js:checked ~ .code-panel #js-panel {
            display: block;
        }

        .vscode-window .keyword {
            color: #569cd6;
        }
        
        .vscode-window .string {
            color: #d69d85;
        }
        
        .vscode-window .comment1 {
            color: #6a9955;
            font-style: italic;
            
            background-color: #142736;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #4a69bd;
            position: relative;
            
        }
        
        .vscode-window .attr {
            color: #9cdcfe;
        }
        
        .vscode-window .value {
            color: #dcdcaa;
        }
        
        .preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .preview-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 100%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }

        .close-preview {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }

        .preview-body {
            line-height: 1.6;
        }

        .preview-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .preview-text {
            margin-bottom: 15px;
        }

        .preview-tags {
            margin-bottom: 15px;
        }

        .preview-difficulty {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
            background: #4a69bd;
        }

        

        /* Темная тема */
        body.dark-theme {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
        }

        body.dark-theme header {
            background: linear-gradient(135deg, #1e1e2e, #2c3e50);
        }

        body.dark-theme nav {
            background: linear-gradient(90deg, #2c3e50 0%, #34495e 100%);
        }

        body.dark-theme .card {
            background: #2d3748;
            color: #e6e6e6;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        body.dark-theme .form-group input,
        body.dark-theme .form-group textarea,
        body.dark-theme .form-group select, 
        body.dark-theme .faq-answer,
        body.dark-theme .math,
        body.dark-theme .auth-content {
            background-color: #4a5568;
            border-color: #2d3748;
            color: #e6e6e6;
        }

        body.dark-theme .form-group label {
            color: #e6e6e6;
        }

        body.dark-theme .comment {
            background-color: #4a5568;
            border-left: 4px solid #6a89cc;
        }

        body.dark-theme .solution {
            background-color: #2d5a2d;
            border-left: 4px solid #4caf50;
        }

        body.dark-theme .solution.best-solution {
            background-color: #5a4e2d;
            border-left: 4px solid #ffc107;
        }

        body.dark-theme .problem {
            border-bottom: 1px solid #4a5568;
        }

        body.dark-theme .search-box input {
            background-color: #4a5568;
            border-color: #2d3748;
            color: #e6e6e6;
        }

        body.dark-theme .faq-header,
        body.dark-theme .preview-header,
        body.dark-theme .faq-content, 
        body.dark-theme .preview-content {
            border-bottom: 2px solid #4a5568;
            background-color: #161f28;
        }
        
        body.dark-theme .auth-modal {
            background-color: rgba(0, 0, 0, 0.5);
        }

        body.dark-theme .vscode-window {
            background: #1a1a2e;
            border: 1px solid #333;
        }

        body.dark-theme .vscode-window .title-bar {
            background: #2c2c3e;
            color: #ccc;
        }

        body.dark-theme .vscode-window .tabs {
            background: #252536;
            border-bottom: 1px solid #444;
        }

        body.dark-theme .vscode-window .code-panel {
            background: #1a1a2e;
            color: #d4d4d4;
        }

        body.dark-theme .empty-state {
            color: #a0aec0;
        }

        body.dark-theme .empty-state i {
            color: #718096;
        }

        body.dark-theme .counter-text {
            color: #a0aec0;
        }

        body.dark-theme .success-message {
            background-color: #2d5a2d;
            color: #c8f7c8;
        }

        body.dark-theme .error-message {
            color: #fc8181;
        }

        body.dark-theme .login-required {
            color: #a0aec0;
        }
        
        /* Новые стили для панели инструментов LaTeX */
        .latex-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .latex-btn {
            padding: 8px 12px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .latex-btn:hover {
            background: #e9ecef;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .latex-btn i {
            margin-right: 5px;
        }
        
        .latex-preview {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            min-height: 60px;
        }
        
        .latex-preview-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #495057;
        }
        
        .latex-preview-content {
            min-height: 30px;
        }
        
        .latex-help {
            margin-top: 5px;
            font-size: 0.8rem;
            color: #6c757d;
        }

        /* Темная тема для панели LaTeX */
        body.dark-theme .latex-toolbar {
            background: #4a5568;
            border-color: #2d3748;
        }
        
        body.dark-theme .latex-btn {
            background: #2d3748;
            border-color: #4a5568;
            color: #e6e6e6;
        }
        
        body.dark-theme .latex-btn:hover {
            background: #4a5568;
        }
        
        body.dark-theme .latex-preview {
            background: #4a5568;
            border-color: #2d3748;
            color: #e6e6e6;
        }
        
        body.dark-theme .latex-preview-title {
            color: #e6e6e6;
        }
        
        body.dark-theme .latex-help {
            color: #a0aec0;
        }
        
        /* Новые стили для страницы профиля */
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-right: 20px;
            background: linear-gradient(135deg, #6a89cc, #4a69bd);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 32px;
            color: white;
            flex-shrink: 0;
        }
        
        .profile-info {
            flex-grow: 1;
        }
        
        .profile-name {
            font-size: 1.33rem;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .profile-description {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            color: #555;
            font-style: italic;
        }
        
        .profile-stats {
            display: flex;
            gap: 5px;
            margin-top: 20px;
        }
        
        .stat-item {
            text-align: center;
            padding: 5px;
            background: #f8f9fa;
            border-radius: 8px;
            min-width: 70px;
            max-height: 100px;
        }
        
        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: #4a69bd;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .profile-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .profile-section {
            background: #f0f0f0;
            border-radius: 2px;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .profile-section-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        
        .profile-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .profile-list-item {
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .profile-list-item:last-child {
            border-bottom: none;
        }
        
        .profile-list-item a {
            color: #4a69bd;
            text-decoration: none;
        }
        
        .profile-list-item a:hover {
            text-decoration: underline;
        }
        
        .empty-profile-list {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }
        
        .account-management {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }
        
        .character-count {
            text-align: right;
            font-size: 0.8rem;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        /* Темная тема для профиля */
        body.dark-theme .profile-name {
            color: #e6e6e6;
        }
        
        body.dark-theme .profile-description {
            background: #4a5568;
            color: #e6e6e6;
        }
        
        body.dark-theme .profile-section {
            background: #2d3748;
            color: #e6e6e6;
        }
        
        body.dark-theme .profile-section-title {
            color: #e6e6e6;
            border-bottom: 1px solid #4a5568;
        }
        
        body.dark-theme .stat-item {
            background: #4a5568;
        }
        
        body.dark-theme .profile-list-item {
            border-bottom: 1px solid #4a5568;
        }
        
        body.dark-theme .profile-list-item a {
            color: #6a89cc;
        }
        
        body.dark-theme .empty-profile-list {
            color: #a0aec0;
        }
        
        body.dark-theme .account-management {
            border-top: 2px solid #4a5568;
        }
        
        /* Стили для кнопки избранного */
        .favorite-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: #ccc;
            transition: all 0.3s;
            padding: 5px;
        }
        
        .favorite-btn:hover {
            color: #ffc107;
            transform: scale(1.2);
        }
        
        .favorite-btn.favorited {
            color: #ffc107;
        }
        
        /* Стили для кнопки лучшего решения */
        .best-solution-btn {
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
            color: #333;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }
        
        .best-solution-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(255, 193, 7, 0.4);
        }
        
        .best-solution-btn i {
            margin-right: 5px;
        }
        
        .file-size-info {
    font-size: 0.8rem;
    color: #7f8c8d;
    margin-top: 5px;
}

.file-size-warning {
    color: #e74c3c;
    font-weight: bold;
}


/* Стили для нового индикатора загрузки */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 24, 48, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-text {
            color: #fff;
            font-size: 1.5rem;
            margin-bottom: 30px;
            text-align: center;
        }

        /* From Uiverse.io by Nawsome */ 
        .typewriter {
            --blue: #5C86FF;
            --blue-dark: #275EFE;
            --key: #fff;
            --paper: #EEF0FD;
            --text: #D3D4EC;
            --tool: #FBC56C;
            --duration: 2s;
            position: relative;
            -webkit-animation: bounce05 var(--duration) linear infinite;
            animation: bounce05 var(--duration) linear infinite;
        }

        .typewriter .slide {
            width: 92px;
            height: 20px;
            border-radius: 3px;
            margin-left: 14px;
            transform: translateX(14px);
            background: linear-gradient(var(--blue), var(--blue-dark));
            -webkit-animation: slide05 var(--duration) ease infinite;
            animation: slide05 var(--duration) ease infinite;
        }

        .typewriter .slide:before, .typewriter .slide:after,
        .typewriter .slide i:before {
            content: "";
            position: absolute;
            background: var(--tool);
        }

        .typewriter .slide:before {
            width: 2px;
            height: 8px;
            top: 6px;
            left: 100%;
        }

        .typewriter .slide:after {
            left: 94px;
            top: 3px;
            height: 14px;
            width: 6px;
            border-radius: 3px;
        }

        .typewriter .slide i {
            display: block;
            position: absolute;
            right: 100%;
            width: 6px;
            height: 4px;
            top: 4px;
            background: var(--tool);
        }

        .typewriter .slide i:before {
            right: 100%;
            top: -2px;
            width: 4px;
            border-radius: 2px;
            height: 14px;
        }

        .typewriter .paper {
            position: absolute;
            left: 24px;
            top: -26px;
            width: 40px;
            height: 46px;
            border-radius: 5px;
            background: var(--paper);
            transform: translateY(46px);
            -webkit-animation: paper05 var(--duration) linear infinite;
            animation: paper05 var(--duration) linear infinite;
        }

        .typewriter .paper:before {
            content: "";
            position: absolute;
            left: 6px;
            right: 6px;
            top: 7px;
            border-radius: 2px;
            height: 4px;
            transform: scaleY(0.8);
            background: var(--text);
            box-shadow: 0 12px 0 var(--text), 0 24px 0 var(--text), 0 36px 0 var(--text);
        }

        .typewriter .keyboard {
            width: 120px;
            height: 56px;
            margin-top: -10px;
            z-index: 1;
            position: relative;
        }

        .typewriter .keyboard:before, .typewriter .keyboard:after {
            content: "";
            position: absolute;
        }

        .typewriter .keyboard:before {
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 7px;
            background: linear-gradient(135deg, var(--blue), var(--blue-dark));
            transform: perspective(10px) rotateX(2deg);
            transform-origin: 50% 100%;
        }

        .typewriter .keyboard:after {
            left: 2px;
            top: 25px;
            width: 11px;
            height: 4px;
            border-radius: 2px;
            box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            -webkit-animation: keyboard05 var(--duration) linear infinite;
            animation: keyboard05 var(--duration) linear infinite;
        }

        @keyframes bounce05 {
            85%, 92%, 100% {
                transform: translateY(0);
            }

            89% {
                transform: translateY(-4px);
            }

            95% {
                transform: translateY(2px);
            }
        }

        @keyframes slide05 {
            5% {
                transform: translateX(14px);
            }

            15%, 30% {
                transform: translateX(6px);
            }

            40%, 55% {
                transform: translateX(0);
            }

            65%, 70% {
                transform: translateX(-4px);
            }

            80%, 89% {
                transform: translateX(-12px);
            }

            100% {
                transform: translateX(14px);
            }
        }

        @keyframes paper05 {
            5% {
                transform: translateY(46px);
            }

            20%, 30% {
                transform: translateY(34px);
            }

            40%, 55% {
                transform: translateY(22px);
            }

            65%, 70% {
                transform: translateY(10px);
            }

            80%, 85% {
                transform: translateY(0);
            }

            92%, 100% {
                transform: translateY(46px);
            }
        }

        @keyframes keyboard05 {
            5%, 12%, 21%, 30%, 39%, 48%, 57%, 66%, 75%, 84% {
                box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            }

            9% {
                box-shadow: 15px 2px 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            }

            18% {
                box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 2px 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            }

            27% {
                box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 12px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            }

            36% {
                box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 12px 0 var(--key), 60px 12px 0 var(--key), 68px 12px 0 var(--key), 83px 10px 0 var(--key);
            }

            45% {
                box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 2px 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            }

            54% {
                box-shadow: 15px 0 0 var(--key), 30px 2px 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            }

            63% {
                box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 12px 0 var(--key);
            }

            72% {
                box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 2px 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            }

            81% {
                box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 12px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
            }
        }


/* From Uiverse.io by RiccardoRapelli - МОДИФИЦИРОВАНО ДЛЯ АНИМАЦИИ В ОБЕ СТОРОНЫ */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
  /* Явно отключаем системные влияния */
  color-scheme: light only !important;
  forced-color-adjust: none !important;
  -webkit-tap-highlight-color: transparent !important;
  filter: none !important;
}

.switch #theme-toggle {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  /* Явно задаем цвет фона для светлой темы */
  background-color: #2196f3 !important;
  -webkit-transition: 0.4s;
  transition: 0.4s;
  z-index: 0;
  overflow: hidden;
  /* Отключаем системные влияния */
  forced-color-adjust: none !important;
  color-scheme: light only !important;
}

.sun-moon {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  /* Яркое желтое солнце по умолчанию */
  background-color: #ffd700 !important;
  -webkit-transition: 0.4s;
  transition: 0.4s;
  /* Добавляем свечение */
  box-shadow: 0 0 10px rgba(255, 215, 0, 0.7) !important;
  /* Отключаем системные влияния */
  forced-color-adjust: none !important;
  /* Анимация для плавного перехода */
  transition: transform 0.6s ease-in-out, background-color 0.6s ease-in-out, box-shadow 0.6s ease-in-out;
}

#theme-toggle:checked + .slider {
  /* Темный фон для ночного режима */
  background-color: #000000 !important;
}

#theme-toggle:focus + .slider {
  box-shadow: 0 0 1px #2196f3;
}

#theme-toggle:checked + .slider .sun-moon {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
  /* Белая луна */
  background-color: #ffffff !important;
  /* Свечение луны */
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.7) !important;
  /* Анимация при переходе в темную тему */
  -webkit-animation: rotate-to-moon 0.6s ease-in-out both;
  animation: rotate-to-moon 0.6s ease-in-out both;
}

/* Анимация при переходе обратно в светлую тему */
#theme-toggle:not(:checked) + .slider .sun-moon {
  -webkit-animation: rotate-to-sun 0.6s ease-in-out both;
  animation: rotate-to-sun 0.6s ease-in-out both;
}

.moon-dot {
  opacity: 0;
  transition: 0.4s;
  /* Серые кратеры луны */
  fill: #888888 !important;
}

#theme-toggle:checked + .slider .sun-moon .moon-dot {
  opacity: 1;
}

.slider.round {
  border-radius: 34px;
}

.slider.round .sun-moon {
  border-radius: 50%;
}

#moon-dot-1 {
  left: 10px;
  top: 3px;
  position: absolute;
  width: 6px;
  height: 6px;
  z-index: 4;
}

#moon-dot-2 {
  left: 2px;
  top: 10px;
  position: absolute;
  width: 10px;
  height: 10px;
  z-index: 4;
}

#moon-dot-3 {
  left: 16px;
  top: 18px;
  position: absolute;
  width: 3px;
  height: 3px;
  z-index: 4;
}

#light-ray-1 {
  left: -8px;
  top: -8px;
  position: absolute;
  width: 43px;
  height: 43px;
  z-index: -1;
  /* Белые лучи */
  fill: #ffffff !important;
  opacity: 20%;
}

#light-ray-2 {
  left: -50%;
  top: -50%;
  position: absolute;
  width: 55px;
  height: 55px;
  z-index: -1;
  fill: #ffffff !important;
  opacity: 15%;
}

#light-ray-3 {
  left: -18px;
  top: -18px;
  position: absolute;
  width: 60px;
  height: 60px;
  z-index: -1;
  fill: #ffffff !important;
  opacity: 10%;
}

.cloud-light {
  position: absolute;
  /* Светлые облака */
  fill: #f8f8f8 !important;
  animation-name: cloud-move;
  animation-duration: 6s;
  animation-iteration-count: infinite;
}

.cloud-dark {
  position: absolute;
  /* Темные облака */
  fill: #e8e8e8 !important;
  animation-name: cloud-move;
  animation-duration: 6s;
  animation-iteration-count: infinite;
  animation-delay: 1s;
}

#cloud-1 {
  left: 30px;
  top: 15px;
  width: 40px;
}

#cloud-2 {
  left: 44px;
  top: 10px;
  width: 20px;
}

#cloud-3 {
  left: 18px;
  top: 24px;
  width: 30px;
}

#cloud-4 {
  left: 36px;
  top: 18px;
  width: 40px;
}

#cloud-5 {
  left: 48px;
  top: 14px;
  width: 20px;
}

#cloud-6 {
  left: 22px;
  top: 26px;
  width: 30px;
}

@keyframes cloud-move {
  0% {
    transform: translateX(0px);
  }

  40% {
    transform: translateX(4px);
  }

  80% {
    transform: translateX(-4px);
  }

  100% {
    transform: translateX(0px);
  }
}

.stars {
  transform: translateY(-32px);
  opacity: 0;
  transition: 0.4s;
}

.star {
  /* Яркие желтые звезды */
  fill: #ffff00 !important;
  position: absolute;
  -webkit-transition: 0.4s;
  transition: 0.4s;
  animation-name: star-twinkle;
  animation-duration: 2s;
  animation-iteration-count: infinite;
  /* Добавляем свечение звездам */
  filter: drop-shadow(0 0 2px yellow) !important;
}

#theme-toggle:checked + .slider .stars {
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0);
  opacity: 1;
}

#star-1 {
  width: 20px;
  top: 2px;
  left: 3px;
  animation-delay: 0.3s;
}

#star-2 {
  width: 6px;
  top: 16px;
  left: 3px;
}

#star-3 {
  width: 12px;
  top: 20px;
  left: 10px;
  animation-delay: 0.6s;
}

#star-4 {
  width: 18px;
  top: 0px;
  left: 18px;
  animation-delay: 1.3s;
}

@keyframes star-twinkle {
  0% {
    transform: scale(1);
  }

  40% {
    transform: scale(1.2);
  }

  80% {
    transform: scale(0.8);
  }

  100% {
    transform: scale(1);
  }
}

.theme-label {
  display: flex;
  align-items: center;
  color: white;
  margin-left: 15px;
  font-size: 0.9rem;
  /* Отключаем системные влияния */
  forced-color-adjust: none !important;
  color-scheme: light only !important;
}

/* Анимация для перехода солнце-луна */
@keyframes rotate-to-moon {
  0% {
    transform: translateX(0) rotate(0);
  }
  100% {
    transform: translateX(26px) rotate(360deg);
  }
}

/* Анимация для перехода луна-солнце */
@keyframes rotate-to-sun {
  0% {
    transform: translateX(26px) rotate(360deg);
  }
  100% {
    transform: translateX(0) rotate(0);
  }
}

/* Принудительно отключаем любые системные темы для этого элемента */
@media (prefers-color-scheme: dark) {
  .switch,
  .switch *,
  .theme-label {
    color-scheme: light only !important;
    forced-color-adjust: none !important;
  }
}

@media (prefers-color-scheme: light) {
  .switch,
  .switch *,
  .theme-label {
    color-scheme: light only !important;
    forced-color-adjust: none !important;
  }
}

        .password-requirements {
            font-size: 0.8rem;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .password-requirements ul {
            margin: 5px 0;
            padding-left: 20px;
        }
        
        .password-error {
            color: #e74c3c;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        .character-count {
            font-size: 0.8rem;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .character-count.error {
            color: #e74c3c;
        }
        
        .validation-error {
            color: #e74c3c;
            font-size: 0.9rem;
            margin-top: 5px;
        }



/* From Uiverse.io by kennyotsu */ 
.card-l {
    /* color used to softly clip top and bottom of the .words container */
    --bg-color: rgb(11, 11, 11, 0.5);
    background-color: var(--bg-color);
    padding: 1rem 2rem;
    border-radius: 1.25rem;
    margin-bottom: 45px; /* Добавляем отступ снизу чтобы отделить от машинки */
}
.loader {
    color: rgb(124, 124, 124);
    font-family: "Poppins", sans-serif;
    font-weight: 500;
    font-size: 25px;
    -webkit-box-sizing: content-box;
    box-sizing: content-box;
    height: 40px;
    padding: 10px 10px;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    border-radius: 8px;
}

.words {
    overflow: hidden;
    position: relative;
}
.words::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
        var(--bg-color) 10%,
        transparent 30%,
        transparent 70%,
        var(--bg-color) 90%
    );
    z-index: 20;
}

.word {
    display: block;
    height: 100%;
    padding-left: 6px;
    color: #956afa;
    animation: spin_4991 2s infinite;
}

@keyframes spin_4991 {
    10% {
        -webkit-transform: translateY(-102%);
        transform: translateY(-102%);
    }

    25% {
        -webkit-transform: translateY(-100%);
        transform: translateY(-100%);
    }

    35% {
        -webkit-transform: translateY(-202%);
        transform: translateY(-202%);
    }

    50% {
        -webkit-transform: translateY(-200%);
        transform: translateY(-200%);
    }

    60% {
        -webkit-transform: translateY(-302%);
        transform: translateY(-302%);
    }

    75% {
        -webkit-transform: translateY(-300%);
        transform: translateY(-300%);
    }

    85% {
        -webkit-transform: translateY(-402%);
        transform: translateY(-402%);
    }

    100% {
        -webkit-transform: translateY(-400%);
        transform: translateY(-400%);
    }
}
    </style>
</head>
<body>
    <header>
        <div class="theme-label">
    <label class="switch">
        <input id="theme-toggle" type="checkbox" />
        <div class="slider round">
            <div class="sun-moon">
                <svg id="moon-dot-1" class="moon-dot" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="moon-dot-2" class="moon-dot" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="moon-dot-3" class="moon-dot" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="light-ray-1" class="light-ray" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="light-ray-2" class="light-ray" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="light-ray-3" class="light-ray" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>

                <svg id="cloud-1" class="cloud-dark" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="cloud-2" class="cloud-dark" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="cloud-3" class="cloud-dark" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="cloud-4" class="cloud-light" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="cloud-5" class="cloud-light" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
                <svg id="cloud-6" class="cloud-light" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50"></circle>
                </svg>
            </div>
            <div class="stars">
                <svg id="star-1" class="star" viewBox="0 0 20 20">
                    <path
                        d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"
                    ></path>
                </svg>
                <svg id="star-2" class="star" viewBox="0 0 20 20">
                    <path
                        d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"
                    ></path>
                </svg>
                <svg id="star-3" class="star" viewBox="0 0 20 20">
                    <path
                        d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"
                    ></path>
                </svg>
                <svg id="star-4" class="star" viewBox="0 0 20 20">
                    <path
                        d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"
                    ></path>
                </svg>
            </div>
        </div>
    </label>
</div>
        <div class="container">
            <h1><img src="data:image/png;base64,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" alt="MathProj Logo" style="height: 1.5em; width: auto; vertical-align: middle; margin-right: 1px;" > MathProj</h1>
            <h1>Математический форум</h1>
            <p>Место для публикации, решения и обсуждения математических задач. Присутствует поддержка шрифта LaTeX для математических выражений.</p>
            
            <div class="user-section">
                
                <div class="user-info" id="user-info" style="display: none;">
                    <div class="user-avatar" id="user-avatar"></div>
                    <span id="user-name"></span>
                </div>
                <button class="btn" id="login-btn"><i class="fas fa-user"></i> Войти</button>
                <button class="btn btn-secondary" id="logout-btn" style="display: none;"><i class="fas fa-sign-out-alt"></i> Выйти</button>
            </div>
        </div>
    </header>
    
    <!-- Модальное окно авторизации -->
    <div class="auth-modal" id="auth-modal">
        <div class="auth-content">
            <div class="auth-tabs">
                <div class="auth-tab active" data-tab="login">Вход</div>
                <div class="auth-tab" data-tab="register">Регистрация</div>
            </div>
            
            <div class="auth-form active" id="login-form">
                <div class="form-group">
                    <label for="login-email">Email:</label>
                    <input type="email" id="login-email" placeholder="Введите ваш email">
                </div>
                <div class="form-group">
                    <label for="login-password">Пароль:</label>
                    <input type="password" id="login-password" placeholder="Введите ваш пароль">
                </div>
                <div id="login-error" class="error-message"></div>
                <button class="btn" id="submit-login"><i class="fas fa-sign-in-alt"></i> Войти</button>
                
                <div class="auth-switch">
                    Нет аккаунта? <a id="switch-to-register">Зарегистрироваться</a>
                </div>
            </div>
            
            <div class="auth-form" id="register-form">
                <div class="form-group">
                    <label for="register-name">Имя:</label>
                    <input type="text" id="register-name" placeholder="Введите ваше имя (максимум 40 символов)" maxlength="40">
                    <div class="character-count">
                        <span id="register-name-chars">0</span>/40 символов
                    </div>
                </div>
                <div class="form-group">
                    <label for="register-email">Email:</label>
                    <input type="email" id="register-email" placeholder="Введите ваш email">
                </div>
                <div class="form-group">
                    <label for="register-password">Пароль:</label>
                    <input type="password" id="register-password" placeholder="Придумайте пароль">
                <div class="password-requirements">
                        Пароль может содержать только:
                        <ul>
                            <li>Минимум 8 символов</li>
                            <li>Только английские буквы (заглавные или строчные)</li>
                            <li>Цифры</li>
                            <li>Точку (.)</li>
                        </ul>
                    </div>
                    <div class="password-error" id="register-password-error"></div>
                </div>
                <div class="form-group">
                    <label for="register-password-confirm">Подтверждение пароля:</label>
                    <input type="password" id="register-password-confirm" placeholder="Повторите пароль">
                </div>
                <div id="register-error" class="error-message"></div>
                <button class="btn" id="submit-register"><i class="fas fa-user-plus"></i> Зарегистрироваться</button>
                
                <div class="auth-switch">
                    Уже есть аккаунт? <a id="switch-to-login">Войти</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно для просмотра изображений -->
    <div class="modal" id="image-modal">
        <span class="close-modal" id="close-modal">&times;</span>
        <img class="modal-content" id="modal-image">
    </div>
    
    <!-- Модальное окно FAQ -->
    <div class="faq-modal" id="faq-modal">
        <div class="faq-content">
            <div class="faq-header">
                <h2><i class="fas fa-question-circle"></i> Ввод математических выражений с помощью LaTeX</h2>
                <button class="close-faq" id="close-faq">&times;</button>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Что это?</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Код LaTeX позволяет вводить математические выражения в том виде, в котором они обычно представлены на бумаге. Например: вместо x^2 LaTeX позволяет выводить $x^2$, ³√(x) —> $\sqrt[3]{x}$, a/b —> $\frac{a}{b}$. Вот сложный пример:
∫ (–∞ → +∞) |3x-3x²|+3x-3x² dx —>

$$\int_{-\infty}^{+\infty} \left| 3x - 3x^2 \right| + 3x - 3x^2  \, dx$$
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Зачем это?</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Представление математических выражений при помощи LaTeX помогает лучше понять условие задачи.$$ \sqrt[]{\frac{x^{sinz} - 1}{\frac{a + 2}{b} + \frac{c}{d - 2}}}$$ ведь легче воспринимается, чем √((x^(sinz) - 1)/((a + 2)/b + c/(d - 2))).
$\int_{-\infty}^{+\infty} e^{-x^2}  \, dx = \sqrt{π}$ вместо ∫ (-∞ → +∞) e^(-x^2) dx = √π также хороший пример. Суть данного сайта — публикация/решение/комментирование задач, очевидно не всегда самых простых. Сложные формулы легче воспринимаются в том виде, в котором они были бы записаны человеком от руки. LaTeX поможет авторам задач представить свои творения в лучшем виде.
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Как оформить выражение на LaTeX?</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Чтобы использовать LaTeX при написании выражений, используются знаки "Доллара" — $\$$ в начале и в конце выражения, если мы хотим подставить его как часть текста; или 2 "Доллара" $\$$ в начале и в конце выражения, если мы хотим его выделить отдельным абзацем из остального текста, "обособить". Например: $\$$ a + \frac{a}{b} $\$$ —> $a + \frac{a}{b}$. А $\$\$$ \alpha + \gamma $\$\$$ —> $$\alpha + \gamma$$ (отдельный абзац).
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Запись логических операций</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Логические операции (+–÷×√∫ и тп) оформляются кодом LaTeX (заключенным в знаках "Доллара") с помощью "\", далее (всë без пробелов) кодировка функции (sqrt, int, frac и тп) и скобки, какие используются для отображения данной логической операции ( [ ], { } и тп). В скобки вводятся входные данные для логической операции. Например: дробь a/b  на языке LaTeX записывается так: \frac{a}{b}, поставьте перед и после этой записи знаки "Доллара" и выражение примет вид, в котором обычно записываются дроби: $$\frac{a}{b}$$ (До и после записи ставятся знаки "Доллара")
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Дроби</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Как вы уже узнали из предыдущего пункта, дробь записывается в виде  \frac{}{}, где в первые фигурные скобки пишется числитель, а во вторые знаменатель. Вы можете использовать дроби как числитель и/или знаменатель, например $\$$ \frac{\frac{a}{b}}{\frac{c}{d}} $\$$ выведет $\frac{\frac{a}{b}}{\frac{c}{d}}$, где $\frac{a}{b}$ — числитель, а $\frac{c}{d}$ — знаменатель.
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Степени и корни</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Степень записывается так ^{ }, где в { } записывается показатель степени, например $\$$ a^{\frac{b}{c}} $\$$ —> $a^{\frac{b}{c}}$. Корень записывается так \sqrt[ ]{ }, где в [ ] пишется степень корня, а в { } пишется подкоренное выражение, например $\$$ \sqrt[3]{x^2 - 1} $\$$ —> $\sqrt[3]{x^2 - 1}$
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Индексы и логарифмы </span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Индекс обозначается так _{ }, где в { } пишется значение индекса, например $\$$ a_{b} $\$$ —> $a_{b}$. Говоря о логарифмах, log, lg, ln пишутся без кодировки, а их основания можно записать как индекс, например $\$$ log_{x + 1} 4 $\$$ —> $log_{x + 1} 4$
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>О модулях</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    В клавиатуре нетрудно найти символ "|", однако к дроби, и вообще ко всему любому составному выражению, применить функцию модуля этим символом не получится. Для обозначения модуля используются \left| (открывает модуль) и \right| (закрывает модуль), например $\$$ \left| \frac{a^3}{b + c} + \sqrt[3]{\frac{x}{x² + 1}} \right| $\$$  —>  $\left| \frac{a^3}{b + c} + \sqrt[3]{\frac{x}{x² + 1}} \right|$
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Интегралы</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Запись интеграла сложна, но мы распишем её по частям. Записывается так $\$$ \int_{a}^{b} f(x) \, dx $\$$ ($\int_{a}^{b} f(x) \, dx$), где вместо a подставляется нижний предел, вместо b — верхний, вместо f(x) — интегрируемая функция. Для записи символа бесконечности используется \infty —> $\infty$. Пример: $\$$ \int_{-\infty}^{+\infty} \left| 3x - 3x^2 \right| + 3x - 3x^2  \, dx $\$$ —> $$\int_{-\infty}^{+\infty} \left| 3x - 3x^2 \right| + 3x - 3x^2  \, dx$$
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Символы</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    Перечень символов, поддерживаемых LaTeX, и их кодировок вы можете посмотреть <a href="https://latex-programming.fandom.com/wiki/List_of_LaTeX_symbols">здесь</a>
                </div>
            </div>
            
        </div>
    </div>
    
    <div class="container">
        <nav>
            <ul>
                <li><a href="#" class="active" id="nav-problems"><i class="fas fa-list"></i> Все задачи</a></li>
                <li><a href="#" id="nav-add"><i class="fas fa-plus-circle"></i> Добавить задачу</a></li>
                <li><a href="#" id="nav-profile"><i class="fas fa-user-circle"></i> Профиль</a></li>
                <li><a href="#" id="nav-about"><i class="fas fa-info-circle"></i>О LaTeX</a></li>
            </ul>
        </nav>
        
        <!-- Добавляем раздел профиля -->
        <div class="card" id="profile-section" style="display: none;">
            <h2 class="section-title"><i class="fas fa-user-circle"></i> Ваш профиль</h2>
            
            <div id="profile-login-required" class="login-required" style="display: none;">
                <p>Для просмотра профиля необходимо войти в аккаунт</p>
                <button class="btn" id="login-for-profile"><i class="fas fa-sign-in-alt"></i> Войти</button>
            </div>
            
            <div id="profile-content" style="display: none;">
                <div class="profile-header">
                    <div class="profile-avatar" id="profile-avatar"></div>
                    <div class="profile-info">
                        <h1 class="profile-name" id="profile-user-name"></h1>
                        <div class="profile-description" id="profile-description"></div>
                        <p>Участник с <span id="profile-registration-date"></span></p>
                        
                        <div class="profile-stats">
                           
                            <div class="stat-item">
                                <div class="stat-number" id="stat-likes-problems">0</div>
                                <div class="stat-label">Лайков за задачи</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="stat-likes-solutions">0</div>
                                <div class="stat-label">Лайков за решения</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="stat-likes-comments">0</div>
                                <div class="stat-label">Лайков за комментарии</div>
                            </div>     
                        </div>
                    </div>
                </div>
                
                <div class="profile-content">
                    <div class="profile-section">
                        <h3 class="profile-section-title">Мои задачи</h3>
                        <div class="profile-list" id="profile-problems-list">
                            <!-- Список задач пользователя -->
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <h3 class="profile-section-title">Мои решения</h3>
                        <div class="profile-list" id="profile-solutions-list">
                            <!-- Список решений пользователя -->
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <h3 class="profile-section-title">Мои комментарии</h3>
                        <div class="profile-list" id="profile-comments-list">
                            <!-- Список комментариев пользователя -->
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <h3 class="profile-section-title">Избранные задачи (50 макс.)</h3>
                        <div class="profile-list" id="profile-favorites-list">
                            <!-- Список избранных задач пользователя -->
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <h3 class="profile-section-title">Лучшие решения</h3>
                        <div class="profile-list" id="profile-best-solutions-list">
                            <!-- Список решений, отмеченных как лучшие -->
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <h3 class="profile-section-title">Активность</h3>
                        <div id="profile-activity">
                            <!-- График или статистика активности --> <div class="stat-item">
                                <div class="stat-number" id="stat-problems">0</div>
                                <div class="stat-label">Задач создано</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="stat-solutions">0</div>
                                <div class="stat-label">Решений добавлено</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="stat-comments">0</div>
                                <div class="stat-label">Комментариев добавлено</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="stat-favorites">0</div>
                                <div class="stat-label">В избранных из 50</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="stat-best-solutions">0</div>
                                <div class="stat-label">Лучших решений получено</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Добавляем кнопку удаления аккаунта -->
                <div class="account-management">
                    <h3 class="profile-section-title">Управление аккаунтом</h3>
                    <div class="form-group">
                        <label for="account-description">Описание профиля (максимум 100 символов):</label>
                        <textarea id="account-description" maxlength="100" placeholder="Расскажите о себе..."></textarea>
                        <div class="character-count">
                            <span id="description-chars">0</span>/100 символов
                        </div>
                    </div>
                    <button class="btn" id="save-description-btn">
                        <i class="fas fa-save"></i> Сохранить описание
                    </button>
                    
                    <!-- Добавляем форму изменения пароля -->
                    <div class="form-group" style="margin-top: 20px;">
                        <h4>Изменение пароля</h4>
                        <label for="old-password">Старый пароль:</label>
                        <input type="password" id="old-password" placeholder="Введите старый пароль">
                        
                        <label for="new-password">Новый пароль:</label>
                        <input type="password" id="new-password" placeholder="Введите новый пароль">
                        <div class="password-requirements">
                            Пароль может содержать только:
                            <ul>
                                <li>Минимум 8 символов</li>
                                <li>Только английские буквы (заглавные или строчные)</li>
                                <li>Цифры</li>
                                <li>Точку (.)</li>
                            </ul>
                        </div>
                        <div class="password-error" id="new-password-error"></div>
                        
                        <label for="confirm-new-password">Подтверждение нового пароля:</label>
                        <input type="password" id="confirm-new-password" placeholder="Повторите новый пароль">
                        <div class="password-error" id="confirm-password-error"></div>
                    </div>
                    <button class="btn" id="change-password-btn">
                        <i class="fas fa-key"></i> Изменить пароль
                    </button>
                    
                    <button class="btn btn-secondary" id="delete-account-btn">
                        <i class="fas fa-trash"></i> Удалить аккаунт
                    </button>
                </div>
            </div>
        </div>
        
        <div id="success-message" class="success-message" style="display: none;">
            <i class="fas fa-check-circle"></i>
            <span>Ваша задача успешно добавлена!</span>
        </div>
        
        <div class="counter">
            <div class="counter-item">
                <div class="counter-number" id="total-problems">0</div>
                <div class="counter-text">Задач</div>
            </div>
            <div class="counter-item">
                <div class="counter-number" id="total-solutions">0</div>
                <div class="counter-text">Решений</div>
            </div>
            <div class="counter-item">
                <div class="counter-number" id="total-comments">0</div>
                <div class="counter-text">Комментариев</div>
            </div>
        </div>
        
        <div class="main-content">
            <div id="problems-section">
                <div class="card">
                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="Поиск по задачам...">
                        <button class="btn" id="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    
                    <!-- Добавлены кнопки сортировки -->
                    <div class="sort-options">
                        <button class="sort-btn active" id="sort-by-date">
                            <i class="fas fa-calendar-alt"></i> Сначала новые
                        </button>
                        <button class="sort-btn" id="sort-by-popularity">
                            <i class="fas fa-fire"></i> По популярности
                        </button>
                    </div>
                </div>
                
                <!-- Пагинация перед списком задач -->
                <div class="card pagination-top" id="pagination-top-container">
                    <!-- Верхняя пагинация будет добавлена сюда через JavaScript -->
                </div>
                
                <div class="card problems-list" id="problems-list">
                    <h2 class="section-title"><i class="fas fa-tasks"></i>Задачи</h2>
                    <!-- Задачи будут загружены здесь через JavaScript -->
                </div>
                
                <!-- Контейнер для пагинации -->
                <div class="card" id="pagination-container">
                    <!-- Пагинация будет добавлена сюда через JavaScript -->
                </div>
                
                <div class="card" id="problem-detail" style="display: none;">
                    <button class="btn" id="back-to-problems"><i class="fas fa-arrow-left"></i> Назад к списку задач</button>
                    
                    <div class="problem">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <h2 id="detail-title"></h2>
                            <button class="favorite-btn" id="toggle-favorite" title="Добавить в избранное">
                                <i class="far fa-star"></i>
                            </button>
                        </div>
                        <div class="problem-meta">
                            <span id="detail-author"></span>
                            <span id="detail-date"></span>
                        </div>
                        <div id="detail-tags" style="margin: 15px 0;"></div>
                        <p id="detail-content"></p>
                        <div id="detail-images" class="attached-images"></div>
                        <div class="reactions" id="problem-reactions">
                            <!-- Кнопки реакций для задачи -->
                        </div>
                        <div id="problem-actions" class="problem-actions" style="display: none;">
                            <button class="btn btn-secondary btn-sm" id="delete-problem"><i class="fas fa-trash"></i> Удалить задачу</button>
                        </div>
                    </div>
                    
                    <h3 class="section-title"><i class="fas fa-check-circle"></i> Решения:</h3>
                    <div id="solutions-list">
                        <!-- Решения будут загружены здесь -->
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <h3 class="section-title"><i class="fas fa-edit"></i> Добавить решение:</h3>
                        <div id="solution-form">
                            <div class="form-group">
                                <label for="solution-content">Ваше решение:</label>
                                <textarea id="solution-content" placeholder="Опишите ваше решение"></textarea>
                            </div>
                            <div class="image-upload">
                                <label class="image-upload-label">Прикрепить фото (PNG/JPEG):</label>
                                <div class="file-size-info">
    Максимальный размер файла: 2 МБ. Рекомендуемый размер: до 500 КБ.
</div>
                                <div class="file-input-wrapper">
                                    <div class="file-input-button">
                                        <i class="fas fa-plus"></i> Прикрепить фото
                                    </div>
                                    <input type="file" id="solution-images" multiple accept=".jpg, .jpeg, .png">
                                </div>
                                <span class="file-name" id="solution-file-names"></span>
                                <div class="image-preview-container" id="solution-image-previews"></div>
                            </div>
                            <button class="btn" id="submit-solution"><i class="fas fa-paper-plane"></i> Отправить решение</button>
                        </div>
                        <div id="solution-login-required" class="login-required" style="display: none;">
                            <p>Чтобы добавить решение, необходимо войти в аккаунт</p>
                            <button class="btn" id="login-for-solution"><i class="fas fa-sign-in-alt"></i> Войти</button>
                        </div>
                    </div>
                    
                    <h3 class="section-title" style="margin-top: 30px;"><i class="fas fa-comments"></i> Комментарии:</h3>
                    <div id="comments-list">
                        <!-- Комментарии будут загружены здесь -->
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <h3 class="section-title"><i class="fas fa-comment"></i> Добавить комментарий:</h3>
                        <div id="comment-form">
                            <div class="form-group">
                                <label for="comment-content">Ваш комментарий:</label>
                                <textarea id="comment-content" placeholder="Введите ваш комментарий"></textarea>
                            </div>
                            <div class="image-upload">
                                <label class="image-upload-label">Прикрепить фото (PNG/JPEG):</label>
                                <div class="file-size-info">
    Максимальный размер файла: 2 МБ. Рекомендуемый размер: до 500 КБ.
</div>
                                <div class="file-input-wrapper">
                                    <div class="file-input-button">
                                        <i class="fas fa-plus"></i> Прикрепить фото
                                    </div>
                                    <input type="file" id="comment-images" multiple accept=".jpg, .jpeg, .png">
                                </div>
                                <span class="file-name" id="comment-file-names"></span>
                                <div class="image-preview-container" id="comment-image-previews"></div>
                            </div>
                            <button class="btn" id="submit-comment"><i class="fas fa-paper-plane"></i> Отправить комментарий</button>
                        </div>
                        <div id="comment-login-required" class="login-required" style="display: none;">
                            <p>Чтобы добавить комментарий, необходимо войти в аккаунт</p>
                            <button class="btn" id="login-for-comment"><i class="fas fa-sign-in-alt"></i> Войти</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div>
                <div class="card" id="add-problem-section">
                    <h2 class="section-title"><i class="fas fa-plus-circle"></i> Добавить новую задачу</h2>
                    <div id="problem-form">
                        <div class="form-group">
                            <label for="problem-title">Название задачи:</label>
                            <input type="text" id="problem-title" placeholder="Введите название задачи">
                        </div>
                        <div class="form-group">
                            <label for="problem-content">Условие задачи:</label>
                            
                    <!-- Панель инструментов LaTeX -->
                    <div class="latex-toolbar">
                        <button type="button" class="latex-btn" data-insert="\frac{ }{ }"><i class="fas fa-divide"></i> Дробь</button>
                        <button type="button" class="latex-btn" data-insert="\sqrt[ ]{ }"><i class="fas fa-square-root-alt"></i> Корень</button>
                        <button type="button" class="latex-btn" data-insert="^{ }"><i class="fas fa-superscript"></i> Степень</button>
                        <button type="button" class="latex-btn" data-insert="_{ }"><i class="fas fa-subscript"></i> Индекс</button>
                        <button type="button" class="latex-btn" data-insert="\int_{ }^{ }"><i class="fas fa-integral"></i>∫ Интеграл</button>
                        <button type="button" class="latex-btn" data-insert="\sum_{ }^{ }"><i class="fas fa-sigma"></i>Σ Сумма</button>
                        <button type="button" class="latex-btn" data-insert="\lim\limits_{n\to\infty}"><i class="fas fa-infinity"></i> Предел</button>
                        <button type="button" class="latex-btn" data-insert="\left( \right)"><i class="fas fa-parentheses"></i> (Скобки)</button>
                        <button type="button" class="latex-btn" data-insert="\left| \right|"><i class="fas fa-absolute-value"></i> |Модуль|</button>
                        <button type="button" class="latex-btn" data-insert="\pi"><i class="fas fa-pi"></i> π</button>
                        <button type="button" class="latex-btn" data-insert="\infty"><i class="fas fa-infinity"></i></button>
                        <button type="button" class="latex-btn" data-insert="\to"><i class="fas fa-to"></i>$\to$</button>
                    </div>
                            
                            <textarea id="problem-content" placeholder="Опишите условие задачи (поддержка кода LaTeX)"></textarea>
                            
                            <div class="character-count" id="problem-content-validation">
        <span>0</span>/2000 символов
    </div>
                            <!-- Блок предпросмотра LaTeX -->
    <div class="latex-preview">
        <div class="latex-preview-title">Предпросмотр формул:</div>
        <div class="latex-preview-content" id="latex-preview"></div>
        <div class="latex-help">Используйте синтаксис LaTeX для формул. Формулы в $\$$...$\$$ будут встроены в текст, а в $\$\$$...$\$\$$ — вынесены отдельно.</div>
    </div>
                        
                        </div>
                        <div class="image-upload">
                            <label class="image-upload-label">Прикрепить фото (PNG/JPEG):</label>
                            <div class="file-size-info">
    Максимальный размер файла: 2 МБ. Рекомендуемый размер: до 500 КБ.
</div>
                            <div class="file-input-wrapper">
                                <div class="file-input-button">
                                    <i class="fas fa-plus"></i> Прикрепить фото
                                </div>
                                <input type="file" id="problem-images" multiple accept=".jpg, .jpeg, .png">
                            </div>
                            <span class="file-name" id="problem-file-names"></span>
                            <div class="image-preview-container" id="problem-image-previews"></div>
                        </div>
                        <div class="form-group">
                            <label for="problem-tags">Теги (через запятую):</label>
                            <input type="text" id="problem-tags" placeholder="Например: алгебра, геометрия, тригонометрия">
                        </div>
                        <div class="form-group">
                            <label for="problem-difficulty">Сложность:</label>
                            <select id="problem-difficulty">
                                <option value="легкая">Легкая</option>
                                <option value="средняя">Средняя</option>
                                <option value="сложная">Сложная</option>
                            </select>
                        </div>
                        
                        <div class="form-group"><button class="btn" id="preview-problem" style="margin-right: 10px;">
    <i class="fas fa-eye"></i> Предпросмотр
</button>
                        </div>
                        <button class="btn" id="submit-problem"><i class="fas fa-plus"></i> Опубликовать задачу</button>
                    </div>
                    <div id="problem-login-required" class="login-required" style="display: none;">
                        <p>Чтобы добавить задачу, необходимо войти в аккаунт</p>
                        <button class="btn" id="login-for-problem"><i class="fas fa-sign-in-alt"></i> Войти</button>
                    </div>
                </div>
            </div>
            <div class="vscode-window">
  <div class="title-bar">
    MathProj — INFO
    <div class="window-controls">
      <div class="close"></div>
      <div class="minimize"></div>
      <div class="maximize"></div>
    </div>
  </div>

  <input class="i" type="radio" name="tab" id="tab-html" checked="" />
  <input class="i" type="radio" name="tab" id="tab-css" />
  <input class="i" type="radio" name="tab" id="tab-js" />

  <div class="tabs">
    <label class="l" for="tab-html">ABOUT.html</label>
    <label class="l" for="tab-css">RULES.css</label>
    <label class="l" for="tab-js">CONTACT.js</label>
  </div>

  <div class="code-panel">
    <div id="html-panel" class="panel">
      <div class="comment1">&lt;-- О форуме --&gt;</div>
      Добро пожаловать на сайт–форум <span class="keyword">MathProj</span>!<br />
      Здесь вы можете:<br />
      &nbsp;&nbsp;&nbsp;&nbsp; <span class="value">• Опубликовывать математические задачи</span><br />
      &nbsp;&nbsp;&nbsp;&nbsp; <span class="value">• Обсуждать их</span><br />
      &nbsp;&nbsp;&nbsp;&nbsp; <span class="value">• Предлагать решения</span><br />
      &nbsp;&nbsp;&nbsp;&nbsp; <span class="value">• Комментировать</span><br />
      &nbsp;&nbsp;&nbsp;&nbsp; <span class="value">• Оценивать</span><br />
      <br />
· Цель: Форум создан для обмена оригинальными математическими задачами, их совместного решения, конструктивного обсуждения и обучения в уважительной атмосфере.<br />
· Аудитория: Мы приветствуем участников с любым уровнем подготовки — от школьников и студентов до профессиональных математиков. Главное — искренний интерес к математике.<br />
· Дух сообщества: Помните, что мы здесь, чтобы учиться друг у друга. Будьте терпеливы, вежливы и помогайте другим, если видите, что можете это сделать.<br />
      <br />
      <span class="string">✮ Обменивайтесь опытом и знаниями! ✮</span><br />
      <br />
      Чиккетти Маттео<br />
      Торресилья Терентьев Луис<br />
      10-В класс, школы 1252 им. Сервантеса<br />
      г. Москва<br />
      2025-2026©
      
    </div>

    <div id="css-panel" class="panel">
      <div class="comment1">&lt;-- Правила форума --&gt;</div>
      1) Оригинальность:<br />
&nbsp;&nbsp;&nbsp;&nbsp;1.1) Опубликовывать можно задачи придуманные вами лично; задачи из малоизвестных источников, с обязательным указанием автора.<br />
&nbsp;&nbsp;&nbsp;&nbsp;1.2) Запрещено выдавать чужие задачи за свои собственные без указания автора. Это плагиат.<br />
&nbsp;&nbsp;&nbsp;&nbsp;1.3) Запрещено выкладывать задачи, из школьной программы (исключения составляют задачи с изменённым/усложнëнным условием).<br /><br />
2) Категоризация. При публикации необходимо указывать:<br />
&nbsp;&nbsp;&nbsp;&nbsp;2.1) Раздел/разделы (алгебра; геометрия: планиметрия, стереометрия; математический анализ и т. п.).<br />
&nbsp;&nbsp;&nbsp;&nbsp;2.2) Уровень сложности (легкий/средний/сложный).<br /><br />
3) Оформление. При составлении задачи:<br />
&nbsp;&nbsp;&nbsp;&nbsp;3.1) Используйте чёткие и однозначные формулировки.<br />
&nbsp;&nbsp;&nbsp;&nbsp;3.2) Проверяйте текст на опечатки и грамматические ошибки перед публикацией задачи.<br /><br />
4) Правила решения и комментирования задач:<br />
&nbsp;&nbsp;&nbsp;&nbsp;4.1) Все комментарии/решения к задаче должны быть связаны с содержанием этой задачи. Избегайте флуда, оффтопа и пустых сообщений.<br />
&nbsp;&nbsp;&nbsp;&nbsp;4.2) Запрещены оскорбления, унизительные комментарии о уровне знаний участника, троллинг.<br />
&nbsp;&nbsp;&nbsp;&nbsp;4.3) Если ваше решение основано на идее из другого комментария, обязательно укажите на это и отдайте должное автору идеи.<br /><br />
5) Правила поведения и коммуникации:<br />
&nbsp;&nbsp;&nbsp;&nbsp;5.1)  Запрещено проявлять ксенофобию, сексизм, буллинг, оскорбление и любое другое неуважительное поведение.<br />
&nbsp;&nbsp;&nbsp;&nbsp;5.2) Запрещена несанкционированная реклама, размещение ссылок на коммерческие продукты или другие ресурсы без согласования с администрацией.<br /><br />
6) Модерация:<br />
&nbsp;&nbsp;&nbsp;&nbsp;6.1) Администрация и модераторы оставляют за собой право удалять задачи/решения/комментарии, если они нарушают правила сайта.<br />
&nbsp;&nbsp;&nbsp;&nbsp;6.2) Все действия модераторов можно обжаловать в личной переписке с администрацией, предоставив свои аргументы. Связаться с администрацией сайта можно в разделе сайта "Обратная связь".<br />
&nbsp;&nbsp;&nbsp;&nbsp;6.3) Публикуя задачу на форуме, вы подтверждаете, что являетесь ее автором или имеете право на ее публикацию.<br />
&nbsp;&nbsp;&nbsp;&nbsp;6.4) Решения, опубликованные на форуме, являются интеллектуальной собственностью их авторов. При использовании их в иных целях требуется указание авторства и ссылки на исходное обсуждение.<br /><br />

Нарушение этих правил может привести к удалению контента. Мы стремимся сохранять наш форум качественным и дружелюбным местом. Спасибо, что вы с нами и вносите вклад в математическое сообщество!
    </div>

    <div id="js-panel" class="panel">
      <div class="comment1">&lt;-- Обратная связь --&gt;</div>
      &nbsp;&nbsp;&nbsp;&nbsp;• <span class="string">Email:</span> <a href="mailto:ila413546@gmail.com">ila413546@gmail.com</a> Торресилья Терентьев Луис<br />
   &nbsp;&nbsp;&nbsp;&nbsp;• <span class="string">Telegram:</span> <a href="https://t.me/ST_se1lut">@ST_se1lut</a> Чиккетти Маттео<br />
   &nbsp;&nbsp;&nbsp;&nbsp;Оставляйте свои жалобы в этот Telegram чат
    </div>
  </div>
</div>
        </div>
    </div>
    
    <div class="preview-modal" id="preview-modal">
    <div class="preview-content">
        <div class="preview-header">
            <h2><i class="fas fa-eye"></i> Предпросмотр задачи</h2>
            <button class="close-preview" id="close-preview">&times;</button>
        </div>
        <div class="preview-body">
            <div class="preview-title" id="preview-title"></div>
            <div class="preview-text" id="preview-content"></div>
            <div class="preview-tags" id="preview-tags"></div>
            <div class="preview-difficulty" id="preview-difficulty"></div>
        </div>
    </div>
</div>


<!-- Индикатор загрузки -->
<div id="loading-overlay" style="display: none;">
    <!-- Новый блок с анимированными словами -->
    <div class="card-l">
        <div class="loader">
            <p>Загружаем</p>
            <div class="words">
                <span class="word"></span>                
                <span class="word">Задачи</span>
                <span class="word">Решения</span>
                <span class="word">Комментарии</span>
                <span class="word">Пользователей</span>
            </div>
        </div>
    </div>
    
    <!-- Пишущая машинка (остается без изменений) -->
    <div class="typewriter">
        <div class="slide"><i></i></div>
        <div class="paper"></div>
        <div class="keyboard"></div>
    </div>
</div>


</body>
</html>
